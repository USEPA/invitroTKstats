<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="John Wambaugh" />

<meta name="date" content="2023-04-26" />

<title>Kreutz 2023 GC PFAS Ultracentrifugation Data</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Kreutz 2023 GC PFAS Ultracentrifugation
Data</h1>
<h4 class="author">John Wambaugh</h4>
<h4 class="date">April 26, 2023</h4>



<p><a href="mailto:wambaugh.john@epa.gov" class="email">wambaugh.john@epa.gov</a></p>
<div id="heres-the-new-r-package-for-analyzing-these-data" class="section level1">
<h1>Here’s the new R package for analyzing these data:</h1>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>    <span class="fu">library</span>(invitroTKstats)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># There are multiple packages for loading Excel files, but I&#39;ve been using this</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># one lately:</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">library</span>(readxl)</span></code></pre></div>
<pre><code># Clear memory:</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span></code></pre></div>
<p>Note that the following code chunks describe how the data.frame
kreutz2023.uc was created. Since we have already created this “level1”
file we can just load it from the invitroTKstats package. Any chunk that
includes the statement “eval = FALSE” is not evaluated when the vignette
is created.</p>
<pre><code># Change to the directory that has your Excel file 
# (this is where it is on my computer):</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>    <span class="fu">setwd</span>(<span class="st">&quot;c:/users/jwambaug/git/invitroTKstats/working/KreutzPFAS&quot;</span>)</span></code></pre></div>
</div>
<div id="assumed-dilution-factors" class="section level1">
<h1>Assumed dilution factors:</h1>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>    CC.DILUTE <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">*</span><span class="dv">4</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>    BLANK.DILUTE <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">*</span><span class="dv">4</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>    AF.DILUTE <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span><span class="dv">4</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    T5.DILUTE <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">*</span><span class="dv">4</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>    T1.DILUTE <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">*</span><span class="dv">4</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    ANALYSIS.METHOD <span class="ot">&lt;-</span> <span class="st">&quot;GCMS&quot;</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>    ANALYSIS.INSTRUMENT <span class="ot">&lt;-</span> <span class="st">&quot;Agilent 8890 GC w 7010 triple quadrupole&quot;</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>    ISTD.CONC <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="co"># uM</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>    UC.ASSAY.T0.CONC <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="co"># uM</span></span></code></pre></div>
</div>
<div id="previously-made-scripts-to-load-some-data" class="section level1">
<h1>Previously made scripts to load some data:</h1>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">suppressMessages</span>(<span class="fu">source</span>(<span class="st">&quot;ak2.r&quot;</span>))</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  AK.UCdata<span class="sc">$</span>DTXSID <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  AK.UCdata[AK.UCdata<span class="sc">$</span>Lab.Compound.Name<span class="sc">==</span><span class="st">&quot;915&quot;</span>,<span class="st">&quot;DTXSID&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;DTXSID4059914&quot;</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  AK.UCdata[AK.UCdata<span class="sc">$</span>Lab.Compound.Name<span class="sc">==</span><span class="st">&quot;965&quot;</span>,<span class="st">&quot;DTXSID&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;DTXSID60379269&quot;</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  AK.UCdata[AK.UCdata<span class="sc">$</span>Lab.Compound.Name<span class="sc">==</span><span class="st">&quot;476&quot;</span>,<span class="st">&quot;DTXSID&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;DTXSID40379666&quot;</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  AK.UCdata[AK.UCdata<span class="sc">$</span>Lab.Compound.Name<span class="sc">==</span><span class="st">&quot;267&quot;</span>,<span class="st">&quot;DTXSID&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;DTXSID10379991&quot;</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  AK.UCdata[AK.UCdata<span class="sc">$</span>Lab.Compound.Name<span class="sc">==</span><span class="st">&quot;3125&quot;</span>,<span class="st">&quot;DTXSID&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;DTXSID70381151&quot;</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  AK.UCdata[AK.UCdata<span class="sc">$</span>Lab.Compound.Name<span class="sc">==</span><span class="st">&quot;906&quot;</span>,<span class="st">&quot;DTXSID&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;DTXSID9059832&quot;</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>  AK.UCdata[AK.UCdata<span class="sc">$</span>Lab.Compound.Name<span class="sc">==</span><span class="st">&quot;273&quot;</span>,<span class="st">&quot;DTXSID&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;DTXSID0059871&quot;</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>  AK.UCdata[AK.UCdata<span class="sc">$</span>Lab.Compound.Name<span class="sc">==</span><span class="st">&quot;913&quot;</span>,<span class="st">&quot;DTXSID&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;DTXSID10382147&quot;</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>  AK.UCdata[AK.UCdata<span class="sc">$</span>Lab.Compound.Name<span class="sc">==</span><span class="st">&quot;4NT&quot;</span>,<span class="st">&quot;DTXSID&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;DTXSID5023792&quot;</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>  AK.UCdata[AK.UCdata<span class="sc">$</span>Lab.Compound.Name<span class="sc">==</span><span class="st">&quot;899&quot;</span>,<span class="st">&quot;DTXSID&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;DTXSID80382093&quot;</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>  AK.UCdata<span class="sc">$</span>Compound.Name <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>  AK.UCdata[AK.UCdata<span class="sc">$</span>Lab.Compound.Name<span class="sc">==</span><span class="st">&quot;915&quot;</span>,<span class="st">&quot;Compound.Name&quot;</span>] <span class="ot">&lt;-</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Heptafluorobutanol&quot;</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>  AK.UCdata[AK.UCdata<span class="sc">$</span>Lab.Compound.Name<span class="sc">==</span><span class="st">&quot;965&quot;</span>,<span class="st">&quot;Compound.Name&quot;</span>] <span class="ot">&lt;-</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;3-(Perfluoropropyl)propanol&quot;</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>  AK.UCdata[AK.UCdata<span class="sc">$</span>Lab.Compound.Name<span class="sc">==</span><span class="st">&quot;476&quot;</span>,<span class="st">&quot;Compound.Name&quot;</span>] <span class="ot">&lt;-</span></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;N-Methyl-N-trimethylsilylheptafluorobutyramide&quot;</span></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>  AK.UCdata[AK.UCdata<span class="sc">$</span>Lab.Compound.Name<span class="sc">==</span><span class="st">&quot;267&quot;</span>,<span class="st">&quot;Compound.Name&quot;</span>] <span class="ot">&lt;-</span></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;3-(Perfluorooctyl)propanol&quot;</span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>  AK.UCdata[AK.UCdata<span class="sc">$</span>Lab.Compound.Name<span class="sc">==</span><span class="st">&quot;3125&quot;</span>,<span class="st">&quot;Compound.Name&quot;</span>] <span class="ot">&lt;-</span></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Perfluorooctanamidine&quot;</span></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>  AK.UCdata[AK.UCdata<span class="sc">$</span>Lab.Compound.Name<span class="sc">==</span><span class="st">&quot;906&quot;</span>,<span class="st">&quot;Compound.Name&quot;</span>] <span class="ot">&lt;-</span></span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Dodecafluoroheptanol&quot;</span></span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>  AK.UCdata[AK.UCdata<span class="sc">$</span>Lab.Compound.Name<span class="sc">==</span><span class="st">&quot;273&quot;</span>,<span class="st">&quot;Compound.Name&quot;</span>] <span class="ot">&lt;-</span></span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Pentafluoropropionamide&quot;</span></span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>  AK.UCdata[AK.UCdata<span class="sc">$</span>Lab.Compound.Name<span class="sc">==</span><span class="st">&quot;913&quot;</span>,<span class="st">&quot;Compound.Name&quot;</span>] <span class="ot">&lt;-</span></span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;3-(Perfluoro-2-butyl)propane-1,2-diol&quot;</span></span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>  AK.UCdata[AK.UCdata<span class="sc">$</span>Lab.Compound.Name<span class="sc">==</span><span class="st">&quot;4NT&quot;</span>,<span class="st">&quot;Compound.Name&quot;</span>] <span class="ot">&lt;-</span> </span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;4-nitrotoluene&quot;</span>  </span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a>  AK.UCdata[AK.UCdata<span class="sc">$</span>Lab.Compound.Name<span class="sc">==</span><span class="st">&quot;899&quot;</span>,<span class="st">&quot;Compound.Name&quot;</span>] <span class="ot">&lt;-</span> </span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;2-Aminohexafluoropropan-2-ol&quot;</span> </span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Really one calibration:</span></span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a>  AK.UCdata[AK.UCdata<span class="sc">$</span>Cal<span class="sc">==</span><span class="st">&quot;2020-02-04&quot;</span>,<span class="st">&quot;Cal&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;2020-02-05&quot;</span></span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a>  AK.UCdata[AK.UCdata<span class="sc">$</span>Cal<span class="sc">==</span><span class="st">&quot;2020-02-24&quot;</span>,<span class="st">&quot;Cal&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;2020-02-25&quot;</span></span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a>  AK.UCdata[AK.UCdata<span class="sc">$</span>Type<span class="sc">==</span><span class="st">&quot;CC&quot;</span>,<span class="st">&quot;Dilution.Factor&quot;</span>] <span class="ot">&lt;-</span> CC.DILUTE</span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a>  AK.UCdata[AK.UCdata<span class="sc">$</span>Type<span class="sc">==</span><span class="st">&quot;AF&quot;</span>,<span class="st">&quot;Dilution.Factor&quot;</span>] <span class="ot">&lt;-</span> AF.DILUTE</span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a>  AK.UCdata[AK.UCdata<span class="sc">$</span>Type<span class="sc">==</span><span class="st">&quot;T1&quot;</span>,<span class="st">&quot;Dilution.Factor&quot;</span>] <span class="ot">&lt;-</span> T1.DILUTE</span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true" tabindex="-1"></a>  AK.UCdata[AK.UCdata<span class="sc">$</span>Type<span class="sc">==</span><span class="st">&quot;T5&quot;</span>,<span class="st">&quot;Dilution.Factor&quot;</span>] <span class="ot">&lt;-</span> T5.DILUTE</span>
<span id="cb7-43"><a href="#cb7-43" aria-hidden="true" tabindex="-1"></a>  AK.UCdata<span class="sc">$</span>Level0.File <span class="ot">&lt;-</span> <span class="st">&quot;21220_915_965_476_267_906_273_913_899_900_analysis_090920.xlsx&quot;</span></span>
<span id="cb7-44"><a href="#cb7-44" aria-hidden="true" tabindex="-1"></a>  AK.UCdata<span class="sc">$</span>Level0.Sheet <span class="ot">&lt;-</span> <span class="st">&quot;UC Data&quot;</span></span>
<span id="cb7-45"><a href="#cb7-45" aria-hidden="true" tabindex="-1"></a>  AK.UCdata[AK.UCdata<span class="sc">$</span>Cal<span class="sc">==</span><span class="st">&quot;2020-02-25&quot;</span>,<span class="st">&quot;Level0.Sheet&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;899_Data0225&quot;</span></span>
<span id="cb7-46"><a href="#cb7-46" aria-hidden="true" tabindex="-1"></a>  AK.UCdata<span class="sc">$</span>Target.Conc <span class="ot">&lt;-</span> AK.UCdata<span class="sc">$</span>Target.Conc<span class="sc">/</span><span class="dv">1000</span></span>
<span id="cb7-47"><a href="#cb7-47" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-48"><a href="#cb7-48" aria-hidden="true" tabindex="-1"></a>  level1.Dec2020 <span class="ot">&lt;-</span> <span class="fu">format_fup_uc</span>(AK.UCdata,</span>
<span id="cb7-49"><a href="#cb7-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">FILENAME=</span><span class="st">&quot;KreutzDec2020&quot;</span>,</span>
<span id="cb7-50"><a href="#cb7-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">sample.col=</span><span class="st">&quot;Name&quot;</span>,</span>
<span id="cb7-51"><a href="#cb7-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">compound.col=</span><span class="st">&quot;Compound.Name&quot;</span>, </span>
<span id="cb7-52"><a href="#cb7-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">lab.compound.col=</span><span class="st">&quot;Lab.Compound.Name&quot;</span>, </span>
<span id="cb7-53"><a href="#cb7-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">type.col=</span><span class="st">&quot;Type&quot;</span>, </span>
<span id="cb7-54"><a href="#cb7-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">std.conc.col=</span><span class="st">&quot;Target.Conc&quot;</span>, </span>
<span id="cb7-55"><a href="#cb7-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">analysis.instrument.col=</span><span class="st">&quot;Instrument&quot;</span>, </span>
<span id="cb7-56"><a href="#cb7-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">analysis.parameters.col=</span><span class="st">&quot;Analysis.Instrument.Param&quot;</span>,</span>
<span id="cb7-57"><a href="#cb7-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">uc.assay.conc =</span> <span class="dv">10</span></span>
<span id="cb7-58"><a href="#cb7-58" aria-hidden="true" tabindex="-1"></a>    )</span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>this.file <span class="ot">&lt;-</span> <span class="st">&quot;021220_915_965_476_267_906_273_913_899_900_analysis_090920.xlsx&quot;</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>this.sheet <span class="ot">&lt;-</span> <span class="st">&quot;899&amp;900 Data&quot;</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>analytes <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">read_excel</span>(this.file, <span class="at">sheet=</span>this.sheet,<span class="at">skip=</span><span class="dv">1</span>))</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>mfoet <span class="ot">&lt;-</span><span class="fu">as.data.frame</span>( <span class="fu">read_excel</span>(this.file, <span class="at">sheet=</span><span class="st">&quot;ControlChart_899&amp;900_MFOET&quot;</span>,<span class="at">skip=</span><span class="dv">1</span>))</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>this.data <span class="ot">&lt;-</span> <span class="fu">merge</span>(analytes,mfoet)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>this.chem.data <span class="ot">&lt;-</span> this.data[,<span class="fu">c</span>(<span class="st">&quot;Name&quot;</span>,<span class="st">&quot;Type&quot;</span>,<span class="st">&quot;Acq. Date-Time&quot;</span>,<span class="st">&quot;Area...17&quot;</span>,<span class="st">&quot;RT...16&quot;</span>,<span class="st">&quot;Resp.&quot;</span>,<span class="st">&quot;Level&quot;</span>)]</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>this.chem.data[<span class="fu">regexpr</span>(<span class="st">&quot;CC&quot;</span>,this.chem.data<span class="sc">$</span>Name)<span class="sc">!=-</span><span class="dv">1</span>,<span class="st">&quot;Sample.Type&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;CC&quot;</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>this.chem.data[<span class="fu">regexpr</span>(<span class="st">&quot;Blank&quot;</span>,this.chem.data<span class="sc">$</span>Name)<span class="sc">!=-</span><span class="dv">1</span>,<span class="st">&quot;Sample.Type&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;CC&quot;</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>this.chem.data[<span class="fu">regexpr</span>(<span class="st">&quot;AF&quot;</span>,this.chem.data<span class="sc">$</span>Name)<span class="sc">!=-</span><span class="dv">1</span>,<span class="st">&quot;Sample.Type&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;AF&quot;</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>this.chem.data[<span class="fu">regexpr</span>(<span class="st">&quot;T5&quot;</span>,this.chem.data<span class="sc">$</span>Name)<span class="sc">!=-</span><span class="dv">1</span>,<span class="st">&quot;Sample.Type&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;T5&quot;</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>this.chem.data[<span class="fu">regexpr</span>(<span class="st">&quot;T1&quot;</span>,this.chem.data<span class="sc">$</span>Name)<span class="sc">!=-</span><span class="dv">1</span>,<span class="st">&quot;Sample.Type&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;T1&quot;</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>  this.chem.data[this.chem.data<span class="sc">$</span>Sample.Type<span class="sc">==</span><span class="st">&quot;CC&quot;</span>,<span class="st">&quot;Dilution.Factor&quot;</span>] <span class="ot">&lt;-</span> CC.DILUTE</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>  this.chem.data[this.chem.data<span class="sc">$</span>Sample.Type<span class="sc">==</span><span class="st">&quot;AF&quot;</span>,<span class="st">&quot;Dilution.Factor&quot;</span>] <span class="ot">&lt;-</span> AF.DILUTE</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>  this.chem.data[this.chem.data<span class="sc">$</span>Sample.Type<span class="sc">==</span><span class="st">&quot;T1&quot;</span>,<span class="st">&quot;Dilution.Factor&quot;</span>] <span class="ot">&lt;-</span> T1.DILUTE</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>  this.chem.data[this.chem.data<span class="sc">$</span>Sample.Type<span class="sc">==</span><span class="st">&quot;T5&quot;</span>,<span class="st">&quot;Dilution.Factor&quot;</span>] <span class="ot">&lt;-</span> T5.DILUTE</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>this.chem.data[<span class="fu">regexpr</span>(<span class="st">&quot;A_GC&quot;</span>,this.chem.data<span class="sc">$</span>Name)<span class="sc">!=-</span><span class="dv">1</span>,<span class="st">&quot;Series&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;A&quot;</span></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>this.chem.data[<span class="fu">regexpr</span>(<span class="st">&quot;B_GC&quot;</span>,this.chem.data<span class="sc">$</span>Name)<span class="sc">!=-</span><span class="dv">1</span>,<span class="st">&quot;Series&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;B&quot;</span></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>this.chem.data[<span class="fu">regexpr</span>(<span class="st">&quot;C_GC&quot;</span>,this.chem.data<span class="sc">$</span>Name)<span class="sc">!=-</span><span class="dv">1</span>,<span class="st">&quot;Series&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;C&quot;</span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Need to map cal curve levels back to concentrations:</span></span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>  CC.levels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">7</span>,<span class="dv">12</span>,<span class="dv">20</span>,<span class="dv">30</span>,<span class="dv">50</span>,<span class="dv">80</span>,<span class="dv">125</span>,<span class="dv">200</span>,<span class="dv">350</span>,<span class="dv">500</span>,<span class="dv">800</span>,<span class="dv">1500</span>,<span class="dv">2500</span>,<span class="dv">3500</span>,<span class="dv">5000</span>)</span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>this.chem.data<span class="sc">$</span>Conc <span class="ot">&lt;-</span> <span class="fu">sapply</span>(this.chem.data<span class="sc">$</span>Level,<span class="cf">function</span>(x) CC.levels[<span class="fu">as.numeric</span>(x)])</span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>this.chem.data[<span class="fu">regexpr</span>(<span class="st">&quot;Blank&quot;</span>,this.chem.data<span class="sc">$</span>Name)<span class="sc">!=-</span><span class="dv">1</span>,<span class="st">&quot;Conc&quot;</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>this.chem.data<span class="sc">$</span>Lab.Compound.Name <span class="ot">&lt;-</span> <span class="st">&quot;900&quot;</span></span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>this.chem.data<span class="sc">$</span>DTXSID <span class="ot">&lt;-</span> <span class="st">&quot;DTXSID0059879&quot;</span></span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>this.chem.data<span class="sc">$</span>Compound.Name <span class="ot">&lt;-</span> <span class="st">&quot;1H,1H,5H-Perfluoropentanol&quot;</span></span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>this.chem.data<span class="sc">$</span>Date <span class="ot">&lt;-</span><span class="st">&quot;2020-02-04&quot;</span></span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a>this.chem.data<span class="sc">$</span>Note <span class="ot">&lt;-</span> <span class="st">&quot;&quot;</span></span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>this.chem.data<span class="sc">$</span>Level0.File <span class="ot">&lt;-</span> this.file</span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a>this.chem.data<span class="sc">$</span>Level0.Sheet <span class="ot">&lt;-</span> this.sheet</span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a>  level1<span class="fl">.900</span> <span class="ot">&lt;-</span> <span class="fu">format_fup_uc</span>(this.chem.data,</span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">FILENAME=</span><span class="st">&quot;Kreutz9002020&quot;</span>,</span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">sample.col=</span><span class="st">&quot;Name&quot;</span>,</span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">compound.col=</span><span class="st">&quot;Compound.Name&quot;</span>, </span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">lab.compound.col=</span><span class="st">&quot;Lab.Compound.Name&quot;</span>, </span>
<span id="cb8-38"><a href="#cb8-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">type.col=</span><span class="st">&quot;Sample.Type&quot;</span>, </span>
<span id="cb8-39"><a href="#cb8-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">std.conc.col=</span><span class="st">&quot;Conc&quot;</span>, </span>
<span id="cb8-40"><a href="#cb8-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">analysis.instrument=</span>ANALYSIS.INSTRUMENT,</span>
<span id="cb8-41"><a href="#cb8-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">analysis.method=</span><span class="st">&quot;GCMS&quot;</span>,</span>
<span id="cb8-42"><a href="#cb8-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">cal.col=</span><span class="st">&quot;Date&quot;</span>,</span>
<span id="cb8-43"><a href="#cb8-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">istd.name=</span><span class="st">&quot;MFOET&quot;</span>,</span>
<span id="cb8-44"><a href="#cb8-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">istd.conc=</span><span class="dv">1</span>,</span>
<span id="cb8-45"><a href="#cb8-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">istd.col=</span><span class="st">&quot;Resp.&quot;</span>,</span>
<span id="cb8-46"><a href="#cb8-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">area.col=</span><span class="st">&quot;Area...17&quot;</span>,</span>
<span id="cb8-47"><a href="#cb8-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">analysis.parameters.col=</span><span class="st">&quot;RT...16&quot;</span>,</span>
<span id="cb8-48"><a href="#cb8-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">uc.assay.conc =</span> <span class="dv">10</span></span>
<span id="cb8-49"><a href="#cb8-49" aria-hidden="true" tabindex="-1"></a>    )</span></code></pre></div>
</div>
<div id="previously-made-scripts-to-load-some-data-1" class="section level1">
<h1>Previously made scripts to load some data:</h1>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">suppressMessages</span>(<span class="fu">source</span>(<span class="st">&quot;uc-test-AK.R&quot;</span>))</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  all.data<span class="sc">$</span>Analysis.Parameters <span class="ot">&lt;-</span> <span class="fu">apply</span>(all.data,<span class="dv">1</span>,<span class="cf">function</span>(x) <span class="fu">paste</span>(</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Analyte RT&quot;</span>,</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">signif</span>(<span class="fu">as.numeric</span>(x[<span class="dv">11</span>]),<span class="dv">5</span>),</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;ISTD RT:&quot;</span>,</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">signif</span>(<span class="fu">as.numeric</span>(x[<span class="dv">15</span>]),<span class="dv">6</span>)))</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  all.data<span class="sc">$</span>Level0.File <span class="ot">&lt;-</span> <span class="st">&quot;120619_PFAS_PPB_Amides_UC_AK_072020.xlsx&quot;</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  all.data<span class="sc">$</span>Level0.Sheet <span class="ot">&lt;-</span> <span class="st">&quot;102919RawOutput&quot;</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>  all.data[all.data<span class="sc">$</span>Cal<span class="sc">==</span><span class="st">&quot;110119&quot;</span>,<span class="st">&quot;Level0.Sheet&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;110119RawOutput&quot;</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>  all.data[all.data<span class="sc">$</span>Cal<span class="sc">==</span><span class="st">&quot;121019&quot;</span>,<span class="st">&quot;Level0.Sheet&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;121019RawOutput&quot;</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>  all.data<span class="sc">$</span>Standard.Conc <span class="ot">&lt;-</span> all.data<span class="sc">$</span>Standard.Conc<span class="sc">/</span><span class="dv">1000</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>  level1.Jul2020 <span class="ot">&lt;-</span> <span class="fu">format_fup_uc</span>(all.data,</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">FILENAME=</span><span class="st">&quot;KreutzJul2020&quot;</span>,</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">uc.assay.conc =</span> <span class="dv">10</span>, </span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">area.col =</span> <span class="st">&quot;Chem.Area&quot;</span>, </span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">compound.col=</span><span class="st">&quot;Name&quot;</span>,</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">std.conc.col=</span><span class="st">&quot;Standard.Conc&quot;</span>,</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">note.col=</span><span class="st">&quot;Comment&quot;</span>,</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">analysis.method=</span><span class="st">&quot;GCMS&quot;</span>,</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">analysis.instrument=</span><span class="st">&quot;Agilent 8890 GC w 7010 triple quadrupole&quot;</span>)</span></code></pre></div>
</div>
<div id="previously-made-scripts-to-load-data" class="section level1">
<h1>Previously made scripts to load data:</h1>
</div>
<div id="pfoa-and-pfos" class="section level1">
<h1>PFOA and PFOS:</h1>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">suppressMessages</span>(<span class="fu">source</span>(<span class="st">&quot;uc-test-052920.R&quot;</span>))</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  all.data<span class="sc">$</span>Lab.Compound.Name <span class="ot">&lt;-</span> all.data<span class="sc">$</span>Compound.Name</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  all.data<span class="sc">$</span>Date <span class="ot">&lt;-</span> <span class="st">&quot;April2019&quot;</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  all.data<span class="sc">$</span>DTXSID <span class="ot">&lt;-</span> <span class="st">&quot;DTXSID8031865&quot;</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  all.data[all.data<span class="sc">$</span>Compound.Name<span class="sc">==</span><span class="st">&quot;PFOS&quot;</span>,<span class="st">&quot;DTXSID&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;DTXSID3031864&quot;</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  all.data<span class="sc">$</span>Compound.Name <span class="ot">&lt;-</span> <span class="st">&quot;Perfluorooctanoic acid&quot;</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>  all.data[all.data<span class="sc">$</span>DTXSID <span class="sc">==</span> <span class="st">&quot;DTXSID3031864&quot;</span>,<span class="st">&quot;Compound.Name&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Perfluorooctanesulfonic acid&quot;</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>  all.data<span class="sc">$</span>Level0.File <span class="ot">&lt;-</span> <span class="st">&quot;20200402_PFAS_UC_PFOA_PFOS.xlsx&quot;</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>  all.data<span class="sc">$</span>Level0.Sheet <span class="ot">&lt;-</span> <span class="st">&quot;PFOA 4-12-19&quot;</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>  all.data[all.data<span class="sc">$</span>Cal<span class="sc">==</span><span class="st">&quot;100119&quot;</span>,<span class="st">&quot;Level0.Sheet&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;PFOA 10-1-19&quot;</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>  all.data[all.data<span class="sc">$</span>Cal<span class="sc">==</span><span class="st">&quot;072319&quot;</span>,<span class="st">&quot;Level0.Sheet&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;PFOS 7-23-19&quot;</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>  all.data[all.data<span class="sc">$</span>Cal<span class="sc">==</span><span class="st">&quot;010720&quot;</span>,<span class="st">&quot;Level0.Sheet&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;PFOS 1-7-2020&quot;</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>  all.data[all.data<span class="sc">$</span>Type<span class="sc">==</span><span class="st">&quot;Blank&quot;</span>, <span class="st">&quot;Dilution.Factor&quot;</span>] <span class="ot">&lt;-</span> BLANK.DILUTE</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>  all.data[all.data<span class="sc">$</span>Type<span class="sc">==</span><span class="st">&quot;Blank&quot;</span>, <span class="st">&quot;Std. Conc&quot;</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>  level1.May2020 <span class="ot">&lt;-</span> <span class="fu">format_fup_uc</span>(all.data,</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">FILENAME=</span><span class="st">&quot;KreutzMay2020&quot;</span>,</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">uc.assay.conc =</span> <span class="dv">10</span>, </span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">area.col =</span> <span class="st">&quot;Area&quot;</span>, </span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">sample.col=</span><span class="st">&quot;Name&quot;</span>,</span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">note.col=</span><span class="st">&quot;Sample.Text&quot;</span>,</span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">compound.col=</span><span class="st">&quot;Compound.Name&quot;</span>,</span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">std.conc.col=</span><span class="st">&quot;Std. Conc&quot;</span>,</span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">analysis.parameters=</span><span class="st">&quot;RT&quot;</span>,</span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">analysis.method=</span><span class="st">&quot;GCMS&quot;</span>,</span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">analysis.instrument=</span><span class="st">&quot;Agilent 8890 GC w 7010 triple quadrupole&quot;</span>,</span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">date.col=</span><span class="st">&quot;Date&quot;</span>,</span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">istd.name=</span><span class="st">&quot;Unknown&quot;</span>,</span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">istd.col=</span><span class="st">&quot;IS.Area&quot;</span>,</span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">istd.conc=</span><span class="dv">1</span>)</span></code></pre></div>
<pre><code># list the data files:</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>    files <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;UC_474_760_3096_final.xlsx&quot;</span>,</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>              <span class="st">&quot;UC_503_507_516_501_505_521_510_120721.xlsx&quot;</span>,</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>              <span class="st">&quot;UC_513_268_275_812_121921.xlsx&quot;</span>,</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>              <span class="st">&quot;UC_763_945_274_964_464_477_479_final-ak.xlsx&quot;</span>,</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>              <span class="st">&quot;UC_959_949_final-ak.xlsx&quot;</span>,</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>              <span class="st">&quot;UC_971_3135_941_902_956_3145_969_final_020322.xlsx&quot;</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>              )</span></code></pre></div>
</div>
<div id="figure-out-the-test-chemical-information" class="section level1">
<h1>Figure out the test chemical information:</h1>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>    chem.start <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">37</span>, <span class="dv">37</span>, <span class="dv">37</span>, <span class="dv">37</span>, <span class="dv">38</span>, <span class="dv">37</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>    cheminfo <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (this.file <span class="cf">in</span> files)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>      these.chems <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">read_excel</span>(this.file,</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">sheet=</span><span class="dv">1</span>,</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">skip =</span> chem.start[<span class="fu">which</span>(files<span class="sc">==</span>this.file)]))</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>      these.chems <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">subset</span>(these.chems,</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>                            <span class="fu">regexpr</span>(<span class="st">&quot;DTXSID&quot;</span>,Analyte)<span class="sc">!=-</span><span class="dv">1</span>))</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>      this.reference <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span> (this.row <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(these.chems)[<span class="dv">1</span>])</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>      {</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.na</span>(these.chems[this.row,<span class="st">&quot;Reference Compound&quot;</span>]))</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>        {</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>          this.reference <span class="ot">&lt;-</span> these.chems[this.row,<span class="st">&quot;Reference Compound&quot;</span>]</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>        } <span class="cf">else</span> {</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>          these.chems[this.row,<span class="st">&quot;Reference Compound&quot;</span>] <span class="ot">&lt;-</span> this.reference</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>      this.istd <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span> (this.row <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(these.chems)[<span class="dv">1</span>])</span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>      {</span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.na</span>(these.chems[this.row,<span class="st">&quot;IS&quot;</span>]))</span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>        {</span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>          this.istd<span class="ot">&lt;-</span> these.chems[this.row,<span class="st">&quot;IS&quot;</span>]</span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>        } <span class="cf">else</span> {</span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>          these.chems[this.row,<span class="st">&quot;IS&quot;</span>] <span class="ot">&lt;-</span> this.istd</span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a>      these.chems<span class="sc">$</span>File <span class="ot">&lt;-</span> this.file</span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a>      this.date <span class="ot">&lt;-</span> <span class="fu">suppressWarnings</span>(<span class="fu">suppressMessages</span>(<span class="fu">as.data.frame</span>(</span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a>        <span class="fu">read_excel</span>(this.file,</span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a>               <span class="at">sheet=</span><span class="dv">1</span>,</span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a>               <span class="at">col_types=</span><span class="st">&quot;date&quot;</span>,</span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true" tabindex="-1"></a>               <span class="at">skip =</span> <span class="dv">3</span>))))[<span class="dv">1</span>,<span class="dv">2</span>]</span>
<span id="cb13-36"><a href="#cb13-36" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (this.file <span class="sc">==</span> <span class="st">&quot;UC_908_909_916_923_3117_final-baw.xlsx&quot;</span>) this.date <span class="ot">&lt;-</span> <span class="st">&quot;2019-09-01&quot;</span></span>
<span id="cb13-37"><a href="#cb13-37" aria-hidden="true" tabindex="-1"></a>      these.chems<span class="sc">$</span>Date <span class="ot">&lt;-</span> this.date</span>
<span id="cb13-38"><a href="#cb13-38" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="sc">!</span>(<span class="st">&quot;Flags&quot;</span> <span class="sc">%in%</span> <span class="fu">colnames</span>(these.chems))) these.chems<span class="sc">$</span>Flags <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb13-39"><a href="#cb13-39" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(cheminfo)) these.chems <span class="ot">&lt;-</span> these.chems[,<span class="fu">colnames</span>(cheminfo)]</span>
<span id="cb13-40"><a href="#cb13-40" aria-hidden="true" tabindex="-1"></a>      cheminfo <span class="ot">&lt;-</span> <span class="fu">rbind</span>(cheminfo,these.chems)</span>
<span id="cb13-41"><a href="#cb13-41" aria-hidden="true" tabindex="-1"></a>    }</span></code></pre></div>
<pre><code># Define the info for control chemicals:</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (this.file <span class="cf">in</span> files)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  this.control <span class="ot">&lt;-</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">data.frame</span>(</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">Analyte =</span> <span class="st">&quot;DTXSID5023792&quot;</span>,</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">Name =</span> <span class="st">&quot;4-nitrotoluene&quot;</span>,</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>      <span class="st">&#39;Sample ID&#39;</span> <span class="ot">=</span> <span class="st">&quot;4NT&quot;</span>,</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">IS =</span> <span class="st">&quot;13C6-4-nitrotoluene&quot;</span>,</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;Reference Compound&quot;</span> <span class="ot">=</span> <span class="cn">NA</span>,</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;Avg. MW&quot;</span> <span class="ot">=</span> <span class="cn">NA</span>,</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;Flags&quot;</span> <span class="ot">=</span> <span class="cn">NA</span>,</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;File&quot;</span> <span class="ot">=</span> this.file)</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>    this.control<span class="sc">$</span>Date <span class="ot">&lt;-</span> <span class="fu">suppressWarnings</span>(<span class="fu">suppressMessages</span>(</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>      <span class="fu">as.data.frame</span>(<span class="fu">read_excel</span>(this.file,</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>               <span class="at">sheet=</span><span class="dv">1</span>,</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>               <span class="at">col_types=</span><span class="st">&quot;date&quot;</span>,</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>               <span class="at">skip =</span> <span class="dv">3</span>))))[<span class="dv">1</span>,<span class="dv">2</span>]</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colnames</span>(this.control)[<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Sample ID&quot;</span></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colnames</span>(this.control)[<span class="dv">5</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Reference Compound&quot;</span></span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colnames</span>(this.control)[<span class="dv">6</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Avg. MW&quot;</span></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>    cheminfo <span class="ot">&lt;-</span> <span class="fu">rbind</span>(cheminfo,this.control)</span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code># Get rid of the UTC:</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>cheminfo[,<span class="st">&quot;Date&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">sapply</span>(cheminfo[,<span class="st">&quot;Date&quot;</span>],<span class="cf">function</span>(x) <span class="fu">gsub</span>(<span class="st">&quot;  UTC&quot;</span>,<span class="st">&quot;&quot;</span>,x))</span></code></pre></div>
<pre><code># Two of the data files keep all data in different columns of the &quot;Data&quot; sheet 
# for each chemical&#39;s respective file.

# Now loop over the files and annotate the data:</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>    UC.data <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (this.file <span class="cf">in</span> files)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="st">&quot;Data&quot;</span> <span class="sc">%in%</span> <span class="fu">excel_sheets</span>(this.file))</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>      {</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>          these.chems <span class="ot">&lt;-</span> <span class="fu">subset</span>(cheminfo,File<span class="sc">==</span>this.file)</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>          <span class="cf">for</span> (this.chem <span class="cf">in</span> <span class="fu">unique</span>(</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>            these.chems<span class="sc">$</span><span class="st">`</span><span class="at">Sample ID</span><span class="st">`</span>))</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>          {</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>          these.data <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>            <span class="fu">suppressMessages</span>(<span class="fu">read_excel</span>(this.file,</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">sheet=</span><span class="st">&quot;Data&quot;</span>)))</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>          start.col.name <span class="ot">&lt;-</span> <span class="fu">paste</span>(this.chem,<span class="st">&quot;Method&quot;</span>)</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>          ANALYTE.OFFSET <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>          ISTD.OFFSET <span class="ot">&lt;-</span> <span class="dv">7</span></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>          ANALYTE.RT.OFFSET <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>          ISTD.RT.OFFSET <span class="ot">&lt;-</span> <span class="dv">6</span></span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>          this.sheet <span class="ot">&lt;-</span> <span class="st">&quot;Data&quot;</span></span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>          <span class="cf">if</span> (<span class="sc">!</span>(start.col.name <span class="sc">%in%</span> <span class="fu">colnames</span>(these.data)))</span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>          {</span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>            these.data <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(</span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>              <span class="fu">suppressMessages</span>(<span class="fu">read_excel</span>(this.file,</span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>              <span class="at">sheet=</span><span class="st">&quot;7bData&quot;</span>)))</span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a>            ANALYTE.OFFSET <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a>            ISTD.OFFSET <span class="ot">&lt;-</span> <span class="dv">6</span></span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a>            ANALYTE.RT.OFFSET <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a>            ISTD.RT.OFFSET <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a>            this.sheet <span class="ot">&lt;-</span> <span class="st">&quot;7bData&quot;</span></span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a>          }</span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a>          first.col <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">colnames</span>(these.data)<span class="sc">==</span>start.col.name)   </span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a>          this.chem.data <span class="ot">&lt;-</span> these.data[</span>
<span id="cb19-32"><a href="#cb19-32" aria-hidden="true" tabindex="-1"></a>            ,<span class="fu">c</span>(first.col<span class="sc">+</span>ANALYTE.OFFSET,first.col<span class="sc">+</span>ISTD.OFFSET,first.col,<span class="dv">3</span>,<span class="dv">7</span>,<span class="dv">6</span>)]</span>
<span id="cb19-33"><a href="#cb19-33" aria-hidden="true" tabindex="-1"></a>          <span class="fu">colnames</span>(this.chem.data) <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb19-34"><a href="#cb19-34" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;Area&quot;</span>,<span class="st">&quot;ISTD.Area&quot;</span>,<span class="st">&quot;NominConc&quot;</span>,<span class="st">&quot;Lab.Sample.Name&quot;</span>,<span class="st">&quot;Type&quot;</span>,<span class="st">&quot;Note&quot;</span>)</span>
<span id="cb19-35"><a href="#cb19-35" aria-hidden="true" tabindex="-1"></a>          this.chem.data<span class="sc">$</span>UC.Assay.T0.Conc <span class="ot">&lt;-</span> UC.ASSAY.T0.CONC</span>
<span id="cb19-36"><a href="#cb19-36" aria-hidden="true" tabindex="-1"></a>          chem.index <span class="ot">&lt;-</span> <span class="fu">which</span>(these.chems<span class="sc">$</span><span class="st">`</span><span class="at">Sample ID</span><span class="st">`</span> <span class="sc">==</span> this.chem)</span>
<span id="cb19-37"><a href="#cb19-37" aria-hidden="true" tabindex="-1"></a>          this.chem.data<span class="sc">$</span>Compound.Name <span class="ot">&lt;-</span> these.chems[chem.index,<span class="st">&quot;Name&quot;</span>]</span>
<span id="cb19-38"><a href="#cb19-38" aria-hidden="true" tabindex="-1"></a>          this.chem.data<span class="sc">$</span>Lab.Compound.Name <span class="ot">&lt;-</span> this.chem</span>
<span id="cb19-39"><a href="#cb19-39" aria-hidden="true" tabindex="-1"></a>          this.chem.data<span class="sc">$</span>DTXSID <span class="ot">&lt;-</span> these.chems[chem.index,<span class="st">&quot;Analyte&quot;</span>]</span>
<span id="cb19-40"><a href="#cb19-40" aria-hidden="true" tabindex="-1"></a>          this.chem.data<span class="sc">$</span>ISTD.Name <span class="ot">&lt;-</span> these.chems[chem.index,<span class="st">&quot;IS&quot;</span>]</span>
<span id="cb19-41"><a href="#cb19-41" aria-hidden="true" tabindex="-1"></a>          this.chem.data<span class="sc">$</span>ISTD.Conc <span class="ot">&lt;-</span> ISTD.CONC</span>
<span id="cb19-42"><a href="#cb19-42" aria-hidden="true" tabindex="-1"></a>          this.chem.data<span class="sc">$</span>Date <span class="ot">&lt;-</span> these.chems[chem.index,<span class="st">&quot;Date&quot;</span>]</span>
<span id="cb19-43"><a href="#cb19-43" aria-hidden="true" tabindex="-1"></a>          this.chem.data<span class="sc">$</span>Cal <span class="ot">&lt;-</span> this.chem.data<span class="sc">$</span>Date</span>
<span id="cb19-44"><a href="#cb19-44" aria-hidden="true" tabindex="-1"></a>          this.chem.data<span class="sc">$</span>Analysis.Parameters <span class="ot">&lt;-</span> <span class="fu">paste</span>(</span>
<span id="cb19-45"><a href="#cb19-45" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;Analyte RT:&quot;</span>,</span>
<span id="cb19-46"><a href="#cb19-46" aria-hidden="true" tabindex="-1"></a>            <span class="fu">signif</span>(</span>
<span id="cb19-47"><a href="#cb19-47" aria-hidden="true" tabindex="-1"></a>              <span class="fu">suppressWarnings</span>(<span class="fu">as.numeric</span>(</span>
<span id="cb19-48"><a href="#cb19-48" aria-hidden="true" tabindex="-1"></a>              these.data[,first.col<span class="sc">+</span>ANALYTE.RT.OFFSET],<span class="dv">5</span>))),</span>
<span id="cb19-49"><a href="#cb19-49" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;ISTD RT:&quot;</span>,</span>
<span id="cb19-50"><a href="#cb19-50" aria-hidden="true" tabindex="-1"></a>            <span class="fu">signif</span>(<span class="fu">suppressWarnings</span>(<span class="fu">as.numeric</span>(</span>
<span id="cb19-51"><a href="#cb19-51" aria-hidden="true" tabindex="-1"></a>              these.data[,first.col<span class="sc">+</span>ISTD.RT.OFFSET],<span class="dv">5</span>)))</span>
<span id="cb19-52"><a href="#cb19-52" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb19-53"><a href="#cb19-53" aria-hidden="true" tabindex="-1"></a>          this.chem.data<span class="sc">$</span>Level0.File <span class="ot">&lt;-</span> this.file</span>
<span id="cb19-54"><a href="#cb19-54" aria-hidden="true" tabindex="-1"></a>          this.chem.data<span class="sc">$</span>Level0.Sheet <span class="ot">&lt;-</span> this.sheet</span>
<span id="cb19-55"><a href="#cb19-55" aria-hidden="true" tabindex="-1"></a>        UC.data <span class="ot">&lt;-</span> <span class="fu">rbind</span>(UC.data,this.chem.data)</span>
<span id="cb19-56"><a href="#cb19-56" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb19-57"><a href="#cb19-57" aria-hidden="true" tabindex="-1"></a>      }  </span></code></pre></div>
</div>
<div id="handle-the-data-for-uc_474_760_3096_final.xlsx" class="section level1">
<h1>Handle the data for “UC_474_760_3096_final.xlsx”</h1>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>  this.file <span class="ot">&lt;-</span> <span class="st">&quot;UC_474_760_3096_final.xlsx&quot;</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  these.chems <span class="ot">&lt;-</span> <span class="fu">subset</span>(cheminfo,File<span class="sc">==</span>this.file)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  new.data <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  this.chem <span class="ot">&lt;-</span> <span class="st">&quot;474&quot;</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>  these.data <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">suppressMessages</span>(<span class="fu">read_excel</span>(this.file,</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">sheet=</span><span class="st">&quot;474Raw&quot;</span>)))</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>  these.data<span class="sc">$</span>Lab.Compound.Name <span class="ot">&lt;-</span> this.chem</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>  new.data <span class="ot">&lt;-</span> <span class="fu">rbind</span>(new.data,these.data)</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>  this.chem <span class="ot">&lt;-</span> <span class="st">&quot;760&quot;</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>  these.data <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">suppressMessages</span>(<span class="fu">read_excel</span>(this.file,</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">sheet=</span><span class="st">&quot;760Raw&quot;</span>)))</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>  these.data<span class="sc">$</span>Lab.Compound.Name <span class="ot">&lt;-</span> this.chem</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(these.data) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(new.data)</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>  new.data <span class="ot">&lt;-</span> <span class="fu">rbind</span>(new.data,these.data)</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>  this.chem <span class="ot">&lt;-</span> <span class="st">&quot;3096&quot;</span></span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>  these.data <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(</span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">suppressMessages</span>(<span class="fu">read_excel</span>(this.file,</span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">sheet=</span><span class="st">&quot;3096Raw&quot;</span>)))</span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>  these.data<span class="sc">$</span>Lab.Compound.Name <span class="ot">&lt;-</span> this.chem</span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(these.data) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(new.data)</span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a>  new.data <span class="ot">&lt;-</span> <span class="fu">rbind</span>(new.data,these.data)</span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a>  this.chem <span class="ot">&lt;-</span> <span class="st">&quot;4NT&quot;</span></span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a>  these.data <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(</span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">suppressMessages</span>(<span class="fu">read_excel</span>(this.file,</span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">sheet=</span><span class="st">&quot;4NTRaw&quot;</span>)))</span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a>  these.data<span class="sc">$</span>A <span class="ot">&lt;-</span> these.data[,<span class="dv">22</span>]</span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true" tabindex="-1"></a>  these.data<span class="sc">$</span>B <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb20-30"><a href="#cb20-30" aria-hidden="true" tabindex="-1"></a>  these.data<span class="sc">$</span>C <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb20-31"><a href="#cb20-31" aria-hidden="true" tabindex="-1"></a>  these.data<span class="sc">$</span>Lab.Compound.Name <span class="ot">&lt;-</span> this.chem</span>
<span id="cb20-32"><a href="#cb20-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(these.data) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(new.data)</span>
<span id="cb20-33"><a href="#cb20-33" aria-hidden="true" tabindex="-1"></a>  new.data <span class="ot">&lt;-</span> <span class="fu">rbind</span>(new.data,these.data)</span>
<span id="cb20-34"><a href="#cb20-34" aria-hidden="true" tabindex="-1"></a>  new.data <span class="ot">&lt;-</span> <span class="fu">subset</span>(new.data,new.data[,<span class="dv">3</span>]<span class="sc">!=</span><span class="st">&quot;Name&quot;</span>)</span>
<span id="cb20-35"><a href="#cb20-35" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb20-36"><a href="#cb20-36" aria-hidden="true" tabindex="-1"></a>  this.chem.data <span class="ot">&lt;-</span> new.data[,</span>
<span id="cb20-37"><a href="#cb20-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="dv">13</span>,<span class="dv">25</span>,<span class="dv">11</span>,<span class="dv">3</span>,<span class="dv">8</span>,<span class="dv">4</span>)]</span>
<span id="cb20-38"><a href="#cb20-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(this.chem.data) <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb20-39"><a href="#cb20-39" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Area&quot;</span>,<span class="st">&quot;ISTD.Area&quot;</span>,<span class="st">&quot;NominConc&quot;</span>,<span class="st">&quot;Lab.Sample.Name&quot;</span>,<span class="st">&quot;Type&quot;</span>,<span class="st">&quot;Note&quot;</span>)</span>
<span id="cb20-40"><a href="#cb20-40" aria-hidden="true" tabindex="-1"></a>  this.chem.data<span class="sc">$</span>UC.Assay.T0.Conc <span class="ot">&lt;-</span> UC.ASSAY.T0.CONC</span>
<span id="cb20-41"><a href="#cb20-41" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (this.chem <span class="cf">in</span> <span class="fu">unique</span>(new.data<span class="sc">$</span>Lab.Compound.Name))</span>
<span id="cb20-42"><a href="#cb20-42" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb20-43"><a href="#cb20-43" aria-hidden="true" tabindex="-1"></a>    which.rows <span class="ot">&lt;-</span> new.data<span class="sc">$</span>Lab.Compound.Name <span class="sc">==</span> this.chem </span>
<span id="cb20-44"><a href="#cb20-44" aria-hidden="true" tabindex="-1"></a>    chem.index <span class="ot">&lt;-</span> <span class="fu">which</span>(these.chems<span class="sc">$</span><span class="st">`</span><span class="at">Sample ID</span><span class="st">`</span> <span class="sc">==</span> this.chem)</span>
<span id="cb20-45"><a href="#cb20-45" aria-hidden="true" tabindex="-1"></a><span class="co"># Get rid of column header rows:</span></span>
<span id="cb20-46"><a href="#cb20-46" aria-hidden="true" tabindex="-1"></a>    this.chem.data[which.rows, <span class="st">&quot;Compound.Name&quot;</span>] <span class="ot">&lt;-</span> these.chems[</span>
<span id="cb20-47"><a href="#cb20-47" aria-hidden="true" tabindex="-1"></a>      chem.index,<span class="st">&quot;Name&quot;</span>]</span>
<span id="cb20-48"><a href="#cb20-48" aria-hidden="true" tabindex="-1"></a>    this.chem.data[which.rows, <span class="st">&quot;Lab.Compound.Name&quot;</span>] <span class="ot">&lt;-</span> this.chem</span>
<span id="cb20-49"><a href="#cb20-49" aria-hidden="true" tabindex="-1"></a>    this.chem.data[which.rows, <span class="st">&quot;DTXSID&quot;</span>] <span class="ot">&lt;-</span> these.chems[</span>
<span id="cb20-50"><a href="#cb20-50" aria-hidden="true" tabindex="-1"></a>      chem.index,<span class="st">&quot;Analyte&quot;</span>]</span>
<span id="cb20-51"><a href="#cb20-51" aria-hidden="true" tabindex="-1"></a>    this.chem.data[which.rows, <span class="st">&quot;ISTD.Name&quot;</span>] <span class="ot">&lt;-</span> these.chems[</span>
<span id="cb20-52"><a href="#cb20-52" aria-hidden="true" tabindex="-1"></a>      chem.index,<span class="st">&quot;IS&quot;</span>]</span>
<span id="cb20-53"><a href="#cb20-53" aria-hidden="true" tabindex="-1"></a>    this.chem.data[which.rows, <span class="st">&quot;ISTD.Conc&quot;</span>] <span class="ot">&lt;-</span> ISTD.CONC</span>
<span id="cb20-54"><a href="#cb20-54" aria-hidden="true" tabindex="-1"></a>    this.chem.data[which.rows, <span class="st">&quot;Date&quot;</span>] <span class="ot">&lt;-</span> these.chems[</span>
<span id="cb20-55"><a href="#cb20-55" aria-hidden="true" tabindex="-1"></a>      chem.index,<span class="st">&quot;Date&quot;</span>]</span>
<span id="cb20-56"><a href="#cb20-56" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb20-57"><a href="#cb20-57" aria-hidden="true" tabindex="-1"></a>  this.chem.data<span class="sc">$</span>Cal <span class="ot">&lt;-</span> this.chem.data<span class="sc">$</span>Date</span>
<span id="cb20-58"><a href="#cb20-58" aria-hidden="true" tabindex="-1"></a>  this.chem.data<span class="sc">$</span>Analysis.Parameters <span class="ot">&lt;-</span> <span class="fu">paste</span>(</span>
<span id="cb20-59"><a href="#cb20-59" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;Analyte RT:&quot;</span>,</span>
<span id="cb20-60"><a href="#cb20-60" aria-hidden="true" tabindex="-1"></a>            <span class="fu">signif</span>(<span class="fu">suppressWarnings</span>(<span class="fu">as.numeric</span>(</span>
<span id="cb20-61"><a href="#cb20-61" aria-hidden="true" tabindex="-1"></a>              new.data[,<span class="dv">12</span>],<span class="dv">5</span>))),</span>
<span id="cb20-62"><a href="#cb20-62" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;ISTD RT:&quot;</span>,</span>
<span id="cb20-63"><a href="#cb20-63" aria-hidden="true" tabindex="-1"></a>            <span class="fu">signif</span>(<span class="fu">suppressWarnings</span>(<span class="fu">as.numeric</span>(</span>
<span id="cb20-64"><a href="#cb20-64" aria-hidden="true" tabindex="-1"></a>              new.data[,<span class="dv">24</span>],<span class="dv">5</span>)))</span>
<span id="cb20-65"><a href="#cb20-65" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb20-66"><a href="#cb20-66" aria-hidden="true" tabindex="-1"></a>  this.chem.data<span class="sc">$</span>Level0.File <span class="ot">&lt;-</span> this.file</span>
<span id="cb20-67"><a href="#cb20-67" aria-hidden="true" tabindex="-1"></a>  this.chem.data<span class="sc">$</span>Level0.Sheet <span class="ot">&lt;-</span> <span class="fu">sapply</span>(this.chem.data<span class="sc">$</span>Lab.Compound.Name,</span>
<span id="cb20-68"><a href="#cb20-68" aria-hidden="true" tabindex="-1"></a>                                        <span class="cf">function</span>(x)</span>
<span id="cb20-69"><a href="#cb20-69" aria-hidden="true" tabindex="-1"></a>                                          <span class="fu">paste</span>(x,<span class="st">&quot;Raw&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>))</span>
<span id="cb20-70"><a href="#cb20-70" aria-hidden="true" tabindex="-1"></a>  UC.data <span class="ot">&lt;-</span> <span class="fu">rbind</span>(UC.data,this.chem.data)  </span>
<span id="cb20-71"><a href="#cb20-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dim</span>(UC.data)</span></code></pre></div>
</div>
<div id="handle-the-data-for-763_945_274_964_464_477_479_final-ak.xlsx" class="section level1">
<h1>Handle the data for “763_945_274_964_464_477_479_final-ak.xlsx”</h1>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>  this.file <span class="ot">&lt;-</span> <span class="st">&quot;UC_763_945_274_964_464_477_479_final-ak.xlsx&quot;</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  this.file.data <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  these.chems <span class="ot">&lt;-</span> <span class="fu">subset</span>(cheminfo,File<span class="sc">==</span>this.file)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Some, but not all data are on individual sheets:</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>  this.chem <span class="ot">&lt;-</span> <span class="st">&quot;477&quot;</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>  these.data <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">suppressMessages</span>(<span class="fu">read_excel</span>(this.file,</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">sheet=</span><span class="st">&quot;477rerun_raw&quot;</span>)))</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>  this.chem.data <span class="ot">&lt;-</span> these.data[,</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="dv">14</span>,<span class="dv">17</span>,<span class="dv">10</span>,<span class="dv">3</span>,<span class="dv">7</span>,<span class="dv">4</span>)]</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(this.chem.data) <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Area&quot;</span>,<span class="st">&quot;ISTD.Area&quot;</span>,<span class="st">&quot;NominConc&quot;</span>,<span class="st">&quot;Lab.Sample.Name&quot;</span>,<span class="st">&quot;Type&quot;</span>,<span class="st">&quot;Note&quot;</span>)</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>  this.chem.data<span class="sc">$</span>Analysis.Parameters <span class="ot">&lt;-</span> <span class="fu">paste</span>(</span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Analyte RT:&quot;</span>,</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">signif</span>(<span class="fu">suppressWarnings</span>(<span class="fu">as.numeric</span>(</span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>    these.data[,<span class="dv">13</span>],<span class="dv">5</span>))),</span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;ISTD RT:&quot;</span>,</span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">signif</span>(<span class="fu">suppressWarnings</span>(<span class="fu">as.numeric</span>(</span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>    these.data[,<span class="dv">16</span>],<span class="dv">5</span>)))</span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a>  this.chem.data<span class="sc">$</span>Level0.Sheet <span class="ot">&lt;-</span> <span class="st">&quot;477rerun_raw&quot;</span></span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>  this.chem.data<span class="sc">$</span>Lab.Compound.Name <span class="ot">&lt;-</span> this.chem</span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a>  this.chem.data<span class="sc">$</span>Note <span class="ot">&lt;-</span> <span class="st">&quot;477rerun&quot;</span></span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a>  this.file.data <span class="ot">&lt;-</span> this.chem.data</span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a>  this.chem <span class="ot">&lt;-</span> <span class="st">&quot;4NT&quot;</span></span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a>  these.data <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(</span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">suppressMessages</span>(<span class="fu">read_excel</span>(this.file,</span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">sheet=</span><span class="st">&quot;4NT_raw&quot;</span>)))</span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true" tabindex="-1"></a>  this.chem.data <span class="ot">&lt;-</span> these.data[,<span class="fu">c</span>(<span class="dv">13</span>,<span class="dv">20</span>,<span class="dv">9</span>,<span class="dv">3</span>,<span class="dv">8</span>,<span class="dv">5</span>)]</span>
<span id="cb21-32"><a href="#cb21-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(this.chem.data) <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb21-33"><a href="#cb21-33" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Area&quot;</span>,<span class="st">&quot;ISTD.Area&quot;</span>,<span class="st">&quot;NominConc&quot;</span>,<span class="st">&quot;Lab.Sample.Name&quot;</span>,<span class="st">&quot;Type&quot;</span>,<span class="st">&quot;Note&quot;</span>)</span>
<span id="cb21-34"><a href="#cb21-34" aria-hidden="true" tabindex="-1"></a>  this.chem.data<span class="sc">$</span>Analysis.Parameters <span class="ot">&lt;-</span> <span class="fu">paste</span>(</span>
<span id="cb21-35"><a href="#cb21-35" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Analyte RT:&quot;</span>,</span>
<span id="cb21-36"><a href="#cb21-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">signif</span>(<span class="fu">suppressWarnings</span>(<span class="fu">as.numeric</span>(</span>
<span id="cb21-37"><a href="#cb21-37" aria-hidden="true" tabindex="-1"></a>    these.data[,<span class="dv">12</span>],<span class="dv">5</span>))),</span>
<span id="cb21-38"><a href="#cb21-38" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;ISTD RT:&quot;</span>,</span>
<span id="cb21-39"><a href="#cb21-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">signif</span>(<span class="fu">suppressWarnings</span>(<span class="fu">as.numeric</span>(</span>
<span id="cb21-40"><a href="#cb21-40" aria-hidden="true" tabindex="-1"></a>    these.data[,<span class="dv">19</span>],<span class="dv">5</span>)))</span>
<span id="cb21-41"><a href="#cb21-41" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb21-42"><a href="#cb21-42" aria-hidden="true" tabindex="-1"></a>  this.chem.data<span class="sc">$</span>Level0.Sheet <span class="ot">&lt;-</span> <span class="st">&quot;4NT_raw&quot;</span></span>
<span id="cb21-43"><a href="#cb21-43" aria-hidden="true" tabindex="-1"></a><span class="co"># Need to map cal curve levels back to concentrations:</span></span>
<span id="cb21-44"><a href="#cb21-44" aria-hidden="true" tabindex="-1"></a>  CC.levels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">5000</span>,</span>
<span id="cb21-45"><a href="#cb21-45" aria-hidden="true" tabindex="-1"></a>    <span class="dv">3500</span>,</span>
<span id="cb21-46"><a href="#cb21-46" aria-hidden="true" tabindex="-1"></a>    <span class="dv">2500</span>,</span>
<span id="cb21-47"><a href="#cb21-47" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1500</span>,</span>
<span id="cb21-48"><a href="#cb21-48" aria-hidden="true" tabindex="-1"></a>    <span class="dv">800</span>,</span>
<span id="cb21-49"><a href="#cb21-49" aria-hidden="true" tabindex="-1"></a>    <span class="dv">500</span>,</span>
<span id="cb21-50"><a href="#cb21-50" aria-hidden="true" tabindex="-1"></a>    <span class="dv">350</span>,</span>
<span id="cb21-51"><a href="#cb21-51" aria-hidden="true" tabindex="-1"></a>    <span class="dv">200</span>,</span>
<span id="cb21-52"><a href="#cb21-52" aria-hidden="true" tabindex="-1"></a>    <span class="dv">125</span>,</span>
<span id="cb21-53"><a href="#cb21-53" aria-hidden="true" tabindex="-1"></a>    <span class="dv">80</span>,</span>
<span id="cb21-54"><a href="#cb21-54" aria-hidden="true" tabindex="-1"></a>    <span class="dv">50</span>,</span>
<span id="cb21-55"><a href="#cb21-55" aria-hidden="true" tabindex="-1"></a>    <span class="dv">30</span>,</span>
<span id="cb21-56"><a href="#cb21-56" aria-hidden="true" tabindex="-1"></a>    <span class="dv">20</span>,</span>
<span id="cb21-57"><a href="#cb21-57" aria-hidden="true" tabindex="-1"></a>    <span class="dv">12</span>,</span>
<span id="cb21-58"><a href="#cb21-58" aria-hidden="true" tabindex="-1"></a>    <span class="dv">7</span>)</span>
<span id="cb21-59"><a href="#cb21-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(CC.levels) <span class="ot">&lt;-</span> <span class="fu">as.character</span>(<span class="fu">seq</span>(<span class="dv">15</span>,<span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>))</span>
<span id="cb21-60"><a href="#cb21-60" aria-hidden="true" tabindex="-1"></a>  this.chem.data[,<span class="st">&quot;NominConc&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">sapply</span>(this.chem.data<span class="sc">$</span>NominConc,</span>
<span id="cb21-61"><a href="#cb21-61" aria-hidden="true" tabindex="-1"></a>                                         <span class="cf">function</span>(x) CC.levels[x])</span>
<span id="cb21-62"><a href="#cb21-62" aria-hidden="true" tabindex="-1"></a>  this.chem.data<span class="sc">$</span>Lab.Compound.Name <span class="ot">&lt;-</span> this.chem</span>
<span id="cb21-63"><a href="#cb21-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-64"><a href="#cb21-64" aria-hidden="true" tabindex="-1"></a>  this.file.data <span class="ot">&lt;-</span> <span class="fu">rbind</span>(this.file.data,this.chem.data)</span>
<span id="cb21-65"><a href="#cb21-65" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-66"><a href="#cb21-66" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Four chemicals on sheet G4B_raw:</span></span>
<span id="cb21-67"><a href="#cb21-67" aria-hidden="true" tabindex="-1"></a>  these.data <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(</span>
<span id="cb21-68"><a href="#cb21-68" aria-hidden="true" tabindex="-1"></a>    <span class="fu">suppressMessages</span>(<span class="fu">read_excel</span>(this.file,</span>
<span id="cb21-69"><a href="#cb21-69" aria-hidden="true" tabindex="-1"></a>    <span class="at">sheet=</span><span class="st">&quot;G4B_raw&quot;</span>)))</span>
<span id="cb21-70"><a href="#cb21-70" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Discard data from 4/20 and 4/22:</span></span>
<span id="cb21-71"><a href="#cb21-71" aria-hidden="true" tabindex="-1"></a>  these.data <span class="ot">&lt;-</span> <span class="fu">subset</span>(these.data, </span>
<span id="cb21-72"><a href="#cb21-72" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.character</span>(<span class="fu">as.Date</span>(<span class="fu">as.numeric</span>(these.data[,<span class="dv">9</span>]), <span class="at">origin =</span> <span class="st">&quot;1899-12-30&quot;</span>)) <span class="sc">==</span></span>
<span id="cb21-73"><a href="#cb21-73" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;2021-04-21&quot;</span>)</span>
<span id="cb21-74"><a href="#cb21-74" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-75"><a href="#cb21-75" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-76"><a href="#cb21-76" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (this.chem <span class="cf">in</span> <span class="fu">c</span>(<span class="st">&quot;964&quot;</span>,<span class="st">&quot;464&quot;</span>,<span class="st">&quot;477&quot;</span>,<span class="st">&quot;479&quot;</span>))</span>
<span id="cb21-77"><a href="#cb21-77" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb21-78"><a href="#cb21-78" aria-hidden="true" tabindex="-1"></a>    start.col <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">colnames</span>(these.data) <span class="sc">==</span> <span class="fu">paste</span>(this.chem,<span class="st">&quot;Results&quot;</span>))</span>
<span id="cb21-79"><a href="#cb21-79" aria-hidden="true" tabindex="-1"></a>    this.chem.data <span class="ot">&lt;-</span> these.data[,<span class="fu">c</span>(start.col<span class="sc">+</span><span class="dv">3</span>,start.col<span class="sc">+</span><span class="dv">6</span>,<span class="dv">8</span>,<span class="dv">3</span>,<span class="dv">7</span>,<span class="dv">4</span>)]</span>
<span id="cb21-80"><a href="#cb21-80" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colnames</span>(this.chem.data) <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb21-81"><a href="#cb21-81" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Area&quot;</span>,<span class="st">&quot;ISTD.Area&quot;</span>,<span class="st">&quot;NominConc&quot;</span>,<span class="st">&quot;Lab.Sample.Name&quot;</span>,<span class="st">&quot;Type&quot;</span>,<span class="st">&quot;Note&quot;</span>)</span>
<span id="cb21-82"><a href="#cb21-82" aria-hidden="true" tabindex="-1"></a>    this.chem.data[,<span class="st">&quot;NominConc&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">sapply</span>(this.chem.data<span class="sc">$</span>NominConc,</span>
<span id="cb21-83"><a href="#cb21-83" aria-hidden="true" tabindex="-1"></a>                                           <span class="cf">function</span>(x) CC.levels[x])</span>
<span id="cb21-84"><a href="#cb21-84" aria-hidden="true" tabindex="-1"></a>    this.chem.data<span class="sc">$</span>Analysis.Parameters<span class="ot">&lt;-</span><span class="fu">apply</span>(these.data,<span class="dv">1</span>,<span class="cf">function</span>(x)</span>
<span id="cb21-85"><a href="#cb21-85" aria-hidden="true" tabindex="-1"></a>      <span class="fu">paste</span>(<span class="st">&quot;Analyte RT:&quot;</span>,</span>
<span id="cb21-86"><a href="#cb21-86" aria-hidden="true" tabindex="-1"></a>            <span class="fu">signif</span>(<span class="fu">as.numeric</span>(x[start.col<span class="sc">+</span><span class="dv">3</span>]),<span class="dv">5</span>),</span>
<span id="cb21-87"><a href="#cb21-87" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;ISTD RT:&quot;</span>,</span>
<span id="cb21-88"><a href="#cb21-88" aria-hidden="true" tabindex="-1"></a>            <span class="fu">signif</span>(<span class="fu">as.numeric</span>(x[start.col<span class="sc">+</span><span class="dv">6</span>]),<span class="dv">5</span>)))</span>
<span id="cb21-89"><a href="#cb21-89" aria-hidden="true" tabindex="-1"></a>    this.chem.data<span class="sc">$</span>Level0.Sheet <span class="ot">&lt;-</span> <span class="st">&quot;G4B_raw&quot;</span></span>
<span id="cb21-90"><a href="#cb21-90" aria-hidden="true" tabindex="-1"></a>    this.chem.data<span class="sc">$</span>Lab.Compound.Name <span class="ot">&lt;-</span> this.chem</span>
<span id="cb21-91"><a href="#cb21-91" aria-hidden="true" tabindex="-1"></a>    this.file.data <span class="ot">&lt;-</span> <span class="fu">rbind</span>(this.file.data,this.chem.data)</span>
<span id="cb21-92"><a href="#cb21-92" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb21-93"><a href="#cb21-93" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-94"><a href="#cb21-94" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Three chemicals on sheet G4A_raw:</span></span>
<span id="cb21-95"><a href="#cb21-95" aria-hidden="true" tabindex="-1"></a>  these.data <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(</span>
<span id="cb21-96"><a href="#cb21-96" aria-hidden="true" tabindex="-1"></a>    <span class="fu">suppressMessages</span>(<span class="fu">read_excel</span>(this.file,</span>
<span id="cb21-97"><a href="#cb21-97" aria-hidden="true" tabindex="-1"></a>    <span class="at">sheet=</span><span class="st">&quot;G4A_raw&quot;</span>)))</span>
<span id="cb21-98"><a href="#cb21-98" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Discard data from second run:</span></span>
<span id="cb21-99"><a href="#cb21-99" aria-hidden="true" tabindex="-1"></a>  these.data <span class="ot">&lt;-</span> these.data[<span class="dv">1</span><span class="sc">:</span><span class="dv">36</span>,]</span>
<span id="cb21-100"><a href="#cb21-100" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-101"><a href="#cb21-101" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (this.chem <span class="cf">in</span> <span class="fu">c</span>(<span class="st">&quot;763&quot;</span>,<span class="st">&quot;945&quot;</span>,<span class="st">&quot;274&quot;</span>))</span>
<span id="cb21-102"><a href="#cb21-102" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb21-103"><a href="#cb21-103" aria-hidden="true" tabindex="-1"></a>    start.col <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">colnames</span>(these.data) <span class="sc">==</span> <span class="fu">paste</span>(this.chem,<span class="st">&quot;Results&quot;</span>))</span>
<span id="cb21-104"><a href="#cb21-104" aria-hidden="true" tabindex="-1"></a>    this.chem.data <span class="ot">&lt;-</span> these.data[,<span class="fu">c</span>(start.col<span class="sc">+</span><span class="dv">3</span>,start.col<span class="sc">+</span><span class="dv">6</span>,<span class="dv">8</span>,<span class="dv">3</span>,<span class="dv">7</span>,<span class="dv">4</span>)]</span>
<span id="cb21-105"><a href="#cb21-105" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colnames</span>(this.chem.data) <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb21-106"><a href="#cb21-106" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Area&quot;</span>,<span class="st">&quot;ISTD.Area&quot;</span>,<span class="st">&quot;NominConc&quot;</span>,<span class="st">&quot;Lab.Sample.Name&quot;</span>,<span class="st">&quot;Type&quot;</span>,<span class="st">&quot;Note&quot;</span>)</span>
<span id="cb21-107"><a href="#cb21-107" aria-hidden="true" tabindex="-1"></a>    this.chem.data[,<span class="st">&quot;NominConc&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">sapply</span>(this.chem.data<span class="sc">$</span>NominConc,</span>
<span id="cb21-108"><a href="#cb21-108" aria-hidden="true" tabindex="-1"></a>                                           <span class="cf">function</span>(x) CC.levels[x])</span>
<span id="cb21-109"><a href="#cb21-109" aria-hidden="true" tabindex="-1"></a>    this.chem.data<span class="sc">$</span>Analysis.Parameters<span class="ot">&lt;-</span><span class="fu">apply</span>(these.data,<span class="dv">1</span>,<span class="cf">function</span>(x)</span>
<span id="cb21-110"><a href="#cb21-110" aria-hidden="true" tabindex="-1"></a>      <span class="fu">paste</span>(<span class="st">&quot;Analyte RT:&quot;</span>,</span>
<span id="cb21-111"><a href="#cb21-111" aria-hidden="true" tabindex="-1"></a>            <span class="fu">signif</span>(<span class="fu">as.numeric</span>(x[start.col<span class="sc">+</span><span class="dv">3</span>]),<span class="dv">5</span>),</span>
<span id="cb21-112"><a href="#cb21-112" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;ISTD RT:&quot;</span>,</span>
<span id="cb21-113"><a href="#cb21-113" aria-hidden="true" tabindex="-1"></a>            <span class="fu">signif</span>(<span class="fu">as.numeric</span>(x[start.col<span class="sc">+</span><span class="dv">6</span>]),<span class="dv">5</span>)))</span>
<span id="cb21-114"><a href="#cb21-114" aria-hidden="true" tabindex="-1"></a>    this.chem.data<span class="sc">$</span>Level0.Sheet <span class="ot">&lt;-</span> <span class="st">&quot;G4A_raw&quot;</span></span>
<span id="cb21-115"><a href="#cb21-115" aria-hidden="true" tabindex="-1"></a>    this.chem.data<span class="sc">$</span>Lab.Compound.Name <span class="ot">&lt;-</span> this.chem</span>
<span id="cb21-116"><a href="#cb21-116" aria-hidden="true" tabindex="-1"></a>    this.file.data <span class="ot">&lt;-</span> <span class="fu">rbind</span>(this.file.data,this.chem.data)</span>
<span id="cb21-117"><a href="#cb21-117" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb21-118"><a href="#cb21-118" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-119"><a href="#cb21-119" aria-hidden="true" tabindex="-1"></a>  this.file.data<span class="ot">&lt;-</span> <span class="fu">subset</span>(this.file.data,Type<span class="sc">!=</span><span class="st">&quot;Type&quot;</span>)</span>
<span id="cb21-120"><a href="#cb21-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-121"><a href="#cb21-121" aria-hidden="true" tabindex="-1"></a>  this.file.data<span class="sc">$</span>UC.Assay.T0.Conc <span class="ot">&lt;-</span> UC.ASSAY.T0.CONC</span>
<span id="cb21-122"><a href="#cb21-122" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (this.chem <span class="cf">in</span> <span class="fu">unique</span>(this.file.data<span class="sc">$</span>Lab.Compound.Name))</span>
<span id="cb21-123"><a href="#cb21-123" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb21-124"><a href="#cb21-124" aria-hidden="true" tabindex="-1"></a>    which.rows <span class="ot">&lt;-</span> this.file.data<span class="sc">$</span>Lab.Compound.Name <span class="sc">==</span> this.chem </span>
<span id="cb21-125"><a href="#cb21-125" aria-hidden="true" tabindex="-1"></a>    chem.index <span class="ot">&lt;-</span> <span class="fu">which</span>(these.chems<span class="sc">$</span><span class="st">`</span><span class="at">Sample ID</span><span class="st">`</span> <span class="sc">==</span> this.chem)</span>
<span id="cb21-126"><a href="#cb21-126" aria-hidden="true" tabindex="-1"></a><span class="co"># Get rid of column header rows:</span></span>
<span id="cb21-127"><a href="#cb21-127" aria-hidden="true" tabindex="-1"></a>    this.file.data[which.rows, <span class="st">&quot;Compound.Name&quot;</span>] <span class="ot">&lt;-</span> these.chems[</span>
<span id="cb21-128"><a href="#cb21-128" aria-hidden="true" tabindex="-1"></a>      chem.index,<span class="st">&quot;Name&quot;</span>]</span>
<span id="cb21-129"><a href="#cb21-129" aria-hidden="true" tabindex="-1"></a>    this.file.data[which.rows, <span class="st">&quot;Lab.Compound.Name&quot;</span>] <span class="ot">&lt;-</span> this.chem</span>
<span id="cb21-130"><a href="#cb21-130" aria-hidden="true" tabindex="-1"></a>    this.file.data[which.rows, <span class="st">&quot;DTXSID&quot;</span>] <span class="ot">&lt;-</span> these.chems[</span>
<span id="cb21-131"><a href="#cb21-131" aria-hidden="true" tabindex="-1"></a>      chem.index,<span class="st">&quot;Analyte&quot;</span>]</span>
<span id="cb21-132"><a href="#cb21-132" aria-hidden="true" tabindex="-1"></a>    this.file.data[which.rows, <span class="st">&quot;ISTD.Name&quot;</span>] <span class="ot">&lt;-</span> these.chems[</span>
<span id="cb21-133"><a href="#cb21-133" aria-hidden="true" tabindex="-1"></a>      chem.index,<span class="st">&quot;IS&quot;</span>]</span>
<span id="cb21-134"><a href="#cb21-134" aria-hidden="true" tabindex="-1"></a>    this.file.data[which.rows, <span class="st">&quot;ISTD.Conc&quot;</span>] <span class="ot">&lt;-</span> ISTD.CONC</span>
<span id="cb21-135"><a href="#cb21-135" aria-hidden="true" tabindex="-1"></a>    this.file.data[which.rows, <span class="st">&quot;Date&quot;</span>] <span class="ot">&lt;-</span> these.chems[</span>
<span id="cb21-136"><a href="#cb21-136" aria-hidden="true" tabindex="-1"></a>      chem.index,<span class="st">&quot;Date&quot;</span>]</span>
<span id="cb21-137"><a href="#cb21-137" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb21-138"><a href="#cb21-138" aria-hidden="true" tabindex="-1"></a>  this.file.data<span class="sc">$</span>Cal <span class="ot">&lt;-</span> this.file.data<span class="sc">$</span>Date</span>
<span id="cb21-139"><a href="#cb21-139" aria-hidden="true" tabindex="-1"></a>  this.file.data<span class="sc">$</span>Level0.File <span class="ot">&lt;-</span> this.file</span>
<span id="cb21-140"><a href="#cb21-140" aria-hidden="true" tabindex="-1"></a>  this.file.data<span class="sc">$</span>Level0.Sheet <span class="ot">&lt;-</span> <span class="st">&quot;G4B_raw&quot;</span></span>
<span id="cb21-141"><a href="#cb21-141" aria-hidden="true" tabindex="-1"></a>  this.file.data[this.file.data<span class="sc">$</span>Lab.Compound.Name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;763&quot;</span>,<span class="st">&quot;945&quot;</span>,<span class="st">&quot;274&quot;</span>),</span>
<span id="cb21-142"><a href="#cb21-142" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&quot;Level0.Sheet&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;G4A_raw&quot;</span></span>
<span id="cb21-143"><a href="#cb21-143" aria-hidden="true" tabindex="-1"></a>  this.file.data[this.file.data<span class="sc">$</span>Lab.Compound.Name <span class="sc">==</span> <span class="st">&quot;4NT&quot;</span>, <span class="st">&quot;Level0.Sheet&quot;</span>] <span class="ot">&lt;-</span></span>
<span id="cb21-144"><a href="#cb21-144" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;4NT_raw&quot;</span></span>
<span id="cb21-145"><a href="#cb21-145" aria-hidden="true" tabindex="-1"></a>  this.file.data[<span class="fu">is.na</span>(this.file.data<span class="sc">$</span>Note),<span class="st">&quot;Note&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;&quot;</span></span>
<span id="cb21-146"><a href="#cb21-146" aria-hidden="true" tabindex="-1"></a>  this.file.data[this.file.data<span class="sc">$</span>Note <span class="sc">==</span> <span class="st">&quot;477rerun&quot;</span>,<span class="st">&quot;Cal&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;070321&quot;</span></span>
<span id="cb21-147"><a href="#cb21-147" aria-hidden="true" tabindex="-1"></a>  this.file.data[this.file.data<span class="sc">$</span>Note <span class="sc">==</span> <span class="st">&quot;477rerun&quot;</span>,<span class="st">&quot;Date&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;070321&quot;</span></span>
<span id="cb21-148"><a href="#cb21-148" aria-hidden="true" tabindex="-1"></a>  this.file.data[this.file.data<span class="sc">$</span>Note <span class="sc">==</span> <span class="st">&quot;477rerun&quot;</span>,<span class="st">&quot;Level0.Sheet&quot;</span>] <span class="ot">&lt;-</span> </span>
<span id="cb21-149"><a href="#cb21-149" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;477rerun_raw&quot;</span></span>
<span id="cb21-150"><a href="#cb21-150" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-151"><a href="#cb21-151" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-152"><a href="#cb21-152" aria-hidden="true" tabindex="-1"></a>  UC.data <span class="ot">&lt;-</span> <span class="fu">rbind</span>(UC.data,this.file.data[,<span class="fu">colnames</span>(UC.data)])  </span>
<span id="cb21-153"><a href="#cb21-153" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dim</span>(UC.data)</span></code></pre></div>
</div>
<div id="handle-the-data-for-uc_959_949_final-ak.xlsx" class="section level1">
<h1>Handle the data for “UC_959_949_final-ak.xlsx”</h1>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>  this.file <span class="ot">&lt;-</span> <span class="st">&quot;UC_959_949_final-ak.xlsx&quot;</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  this.file.data <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  these.chems <span class="ot">&lt;-</span> <span class="fu">subset</span>(cheminfo,File<span class="sc">==</span>this.file)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Four chemicals on sheet G4B_raw:</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>  these.data <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">suppressMessages</span>(<span class="fu">read_excel</span>(this.file,</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">sheet=</span><span class="st">&quot;RawData&quot;</span>)))</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (this.chem <span class="cf">in</span> <span class="fu">c</span>(<span class="st">&quot;959&quot;</span>,<span class="st">&quot;4NT&quot;</span>,<span class="st">&quot;949&quot;</span>))</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>    start.col <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">colnames</span>(these.data) <span class="sc">==</span> <span class="fu">paste</span>(this.chem,<span class="st">&quot;Results&quot;</span>))</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>    this.chem.data <span class="ot">&lt;-</span> these.data[,<span class="fu">c</span>(start.col<span class="sc">+</span><span class="dv">1</span>,start.col<span class="sc">+</span><span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">2</span>)]</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colnames</span>(this.chem.data) <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Area&quot;</span>,<span class="st">&quot;ISTD.Area&quot;</span>,<span class="st">&quot;NominConc&quot;</span>,<span class="st">&quot;Lab.Sample.Name&quot;</span>,<span class="st">&quot;Type&quot;</span>,<span class="st">&quot;Note&quot;</span>)</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>    this.chem.data[,<span class="st">&quot;NominConc&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">sapply</span>(this.chem.data<span class="sc">$</span>NominConc,</span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>                                           <span class="cf">function</span>(x) CC.levels[x])</span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>    this.chem.data<span class="sc">$</span>Analysis.Parameters<span class="ot">&lt;-</span><span class="fu">apply</span>(these.data,<span class="dv">1</span>,<span class="cf">function</span>(x)</span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>      <span class="fu">paste</span>(<span class="st">&quot;Analyte RT:&quot;</span>,</span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>            <span class="fu">signif</span>(<span class="fu">as.numeric</span>(x[start.col<span class="sc">+</span><span class="dv">0</span>]),<span class="dv">5</span>),</span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;ISTD RT:&quot;</span>,</span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a>            <span class="fu">signif</span>(<span class="fu">as.numeric</span>(x[start.col<span class="sc">+</span><span class="dv">5</span>]),<span class="dv">5</span>)))</span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a>    this.chem.data<span class="sc">$</span>Level0.Sheet <span class="ot">&lt;-</span> <span class="st">&quot;RawData&quot;</span></span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a>    this.chem.data<span class="sc">$</span>Lab.Compound.Name <span class="ot">&lt;-</span> this.chem</span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a>    this.file.data <span class="ot">&lt;-</span> <span class="fu">rbind</span>(this.file.data,this.chem.data)</span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-28"><a href="#cb22-28" aria-hidden="true" tabindex="-1"></a>  this.file.data<span class="ot">&lt;-</span> <span class="fu">subset</span>(this.file.data,Type<span class="sc">!=</span><span class="st">&quot;Type&quot;</span>)</span>
<span id="cb22-29"><a href="#cb22-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-30"><a href="#cb22-30" aria-hidden="true" tabindex="-1"></a>  this.file.data<span class="sc">$</span>UC.Assay.T0.Conc <span class="ot">&lt;-</span> UC.ASSAY.T0.CONC</span>
<span id="cb22-31"><a href="#cb22-31" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (this.chem <span class="cf">in</span> <span class="fu">unique</span>(this.file.data<span class="sc">$</span>Lab.Compound.Name))</span>
<span id="cb22-32"><a href="#cb22-32" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb22-33"><a href="#cb22-33" aria-hidden="true" tabindex="-1"></a>    which.rows <span class="ot">&lt;-</span> this.file.data<span class="sc">$</span>Lab.Compound.Name <span class="sc">==</span> this.chem </span>
<span id="cb22-34"><a href="#cb22-34" aria-hidden="true" tabindex="-1"></a>    chem.index <span class="ot">&lt;-</span> <span class="fu">which</span>(these.chems<span class="sc">$</span><span class="st">`</span><span class="at">Sample ID</span><span class="st">`</span> <span class="sc">==</span> this.chem)</span>
<span id="cb22-35"><a href="#cb22-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Get rid of column header rows:</span></span>
<span id="cb22-36"><a href="#cb22-36" aria-hidden="true" tabindex="-1"></a>    this.file.data[which.rows, <span class="st">&quot;Compound.Name&quot;</span>] <span class="ot">&lt;-</span> these.chems[</span>
<span id="cb22-37"><a href="#cb22-37" aria-hidden="true" tabindex="-1"></a>      chem.index,<span class="st">&quot;Name&quot;</span>]</span>
<span id="cb22-38"><a href="#cb22-38" aria-hidden="true" tabindex="-1"></a>    this.file.data[which.rows, <span class="st">&quot;Lab.Compound.Name&quot;</span>] <span class="ot">&lt;-</span> this.chem</span>
<span id="cb22-39"><a href="#cb22-39" aria-hidden="true" tabindex="-1"></a>    this.file.data[which.rows, <span class="st">&quot;DTXSID&quot;</span>] <span class="ot">&lt;-</span> these.chems[</span>
<span id="cb22-40"><a href="#cb22-40" aria-hidden="true" tabindex="-1"></a>      chem.index,<span class="st">&quot;Analyte&quot;</span>]</span>
<span id="cb22-41"><a href="#cb22-41" aria-hidden="true" tabindex="-1"></a>    this.file.data[which.rows, <span class="st">&quot;ISTD.Name&quot;</span>] <span class="ot">&lt;-</span> these.chems[</span>
<span id="cb22-42"><a href="#cb22-42" aria-hidden="true" tabindex="-1"></a>      chem.index,<span class="st">&quot;IS&quot;</span>]</span>
<span id="cb22-43"><a href="#cb22-43" aria-hidden="true" tabindex="-1"></a>    this.file.data[which.rows, <span class="st">&quot;ISTD.Conc&quot;</span>] <span class="ot">&lt;-</span> ISTD.CONC</span>
<span id="cb22-44"><a href="#cb22-44" aria-hidden="true" tabindex="-1"></a>    this.file.data[which.rows, <span class="st">&quot;Date&quot;</span>] <span class="ot">&lt;-</span> these.chems[</span>
<span id="cb22-45"><a href="#cb22-45" aria-hidden="true" tabindex="-1"></a>      chem.index,<span class="st">&quot;Date&quot;</span>]</span>
<span id="cb22-46"><a href="#cb22-46" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb22-47"><a href="#cb22-47" aria-hidden="true" tabindex="-1"></a>  this.file.data<span class="sc">$</span>Cal <span class="ot">&lt;-</span> this.file.data<span class="sc">$</span>Date</span>
<span id="cb22-48"><a href="#cb22-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-49"><a href="#cb22-49" aria-hidden="true" tabindex="-1"></a>  this.file.data<span class="sc">$</span>Level0.File <span class="ot">&lt;-</span> this.file</span>
<span id="cb22-50"><a href="#cb22-50" aria-hidden="true" tabindex="-1"></a>  this.file.data<span class="sc">$</span>Level0.Sheet <span class="ot">&lt;-</span> <span class="st">&quot;RawData&quot;</span></span>
<span id="cb22-51"><a href="#cb22-51" aria-hidden="true" tabindex="-1"></a>  UC.data <span class="ot">&lt;-</span> <span class="fu">rbind</span>(UC.data,this.file.data[,<span class="fu">colnames</span>(UC.data)])  </span>
<span id="cb22-52"><a href="#cb22-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dim</span>(UC.data)</span></code></pre></div>
</div>
<div id="handle-the-data-for-uc_971_3135_941_902_956_3145_969_final_020322.xlsx" class="section level1">
<h1>Handle the data for
“UC_971_3135_941_902_956_3145_969_final_020322.xlsx”</h1>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>  this.file <span class="ot">&lt;-</span> <span class="st">&quot;UC_971_3135_941_902_956_3145_969_final_020322.xlsx&quot;</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  this.file.data <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  these.chems <span class="ot">&lt;-</span> <span class="fu">subset</span>(cheminfo,File<span class="sc">==</span>this.file<span class="sc">|</span><span class="st">&quot;Sample ID&quot;</span><span class="sc">==</span><span class="st">&quot;4NT&quot;</span>)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  these.data <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">suppressMessages</span>(<span class="fu">read_excel</span>(this.file,</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>                                <span class="at">skip=</span><span class="dv">1</span>,</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">sheet=</span><span class="st">&quot;All Raw data and Calcs&quot;</span>)))</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>  analyte.cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;4NT...10&quot;</span>,<span class="st">&quot;4:2FTOH...12&quot;</span>,<span class="st">&quot;6:1FTOH...13&quot;</span>,<span class="st">&quot;6:2FTOH...14&quot;</span>,</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&quot;4:4FTOH...15&quot;</span>,<span class="st">&quot;8:2FTOH...16&quot;</span>,<span class="st">&quot;7:3FTOH...17&quot;</span>,</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&quot;11:1FTOH...18&quot;</span>)</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>  chems <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;4NT&quot;</span>,<span class="st">&quot;4:2 FTOH aka 971&quot;</span>,<span class="st">&quot;6:1 FTOH aka 3135&quot;</span>,</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;6:2 FTOH aka 941&quot;</span>,<span class="st">&quot;4:4 FTOH aka 902&quot;</span>,<span class="st">&quot;8:2 FTOH aka 956&quot;</span>,</span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;7:3 FTOH aka 3145&quot;</span>,<span class="st">&quot;11:1 FTOH aka 969&quot;</span>)</span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>  istd.cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;m4NT&quot;</span>,<span class="st">&quot;m4:2 FTOH&quot;</span>, <span class="st">&quot;m6:2FTOH&quot;</span>,<span class="st">&quot;m6:2FTOH&quot;</span>,<span class="st">&quot;m6:2FTOH&quot;</span>,</span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;m8:2FTOH&quot;</span>,<span class="st">&quot;m8:2FTOH&quot;</span>,<span class="st">&quot;m8:2FTOH&quot;</span>)</span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (chem.index <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>)</span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a>    this.chem <span class="ot">&lt;-</span> chems[chem.index]</span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a>    this.chem.data <span class="ot">&lt;-</span> these.data[,<span class="fu">c</span>(</span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a>      <span class="fu">which</span>(<span class="fu">colnames</span>(these.data)<span class="sc">==</span>analyte.cols[chem.index]),</span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a>      <span class="fu">which</span>(<span class="fu">colnames</span>(these.data)<span class="sc">==</span>istd.cols[chem.index]),</span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a>                                    <span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">1</span>)]</span>
<span id="cb23-26"><a href="#cb23-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colnames</span>(this.chem.data) <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb23-27"><a href="#cb23-27" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Area&quot;</span>,<span class="st">&quot;ISTD.Area&quot;</span>,<span class="st">&quot;NominConc&quot;</span>,<span class="st">&quot;Lab.Sample.Name&quot;</span>,<span class="st">&quot;Type&quot;</span>,<span class="st">&quot;Note&quot;</span>)</span>
<span id="cb23-28"><a href="#cb23-28" aria-hidden="true" tabindex="-1"></a>    this.chem.data<span class="sc">$</span>Analysis.Parameters<span class="ot">&lt;-</span>these.data[<span class="dv">1</span>,analyte.cols[chem.index]]</span>
<span id="cb23-29"><a href="#cb23-29" aria-hidden="true" tabindex="-1"></a>    this.chem.data<span class="sc">$</span>Level0.Sheet <span class="ot">&lt;-</span> <span class="st">&quot;All Raw data and Calcs&quot;</span></span>
<span id="cb23-30"><a href="#cb23-30" aria-hidden="true" tabindex="-1"></a>    this.chem.data<span class="sc">$</span>Lab.Compound.Name <span class="ot">&lt;-</span> this.chem</span>
<span id="cb23-31"><a href="#cb23-31" aria-hidden="true" tabindex="-1"></a>    this.file.data <span class="ot">&lt;-</span> <span class="fu">rbind</span>(this.file.data,this.chem.data)</span>
<span id="cb23-32"><a href="#cb23-32" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb23-33"><a href="#cb23-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-34"><a href="#cb23-34" aria-hidden="true" tabindex="-1"></a>  this.file.data<span class="ot">&lt;-</span> <span class="fu">subset</span>(this.file.data,<span class="sc">!</span><span class="fu">is.na</span>(Type))</span>
<span id="cb23-35"><a href="#cb23-35" aria-hidden="true" tabindex="-1"></a>  this.file.data<span class="ot">&lt;-</span> <span class="fu">subset</span>(this.file.data,Type<span class="sc">!=</span><span class="st">&quot;Sample&quot;</span>)</span>
<span id="cb23-36"><a href="#cb23-36" aria-hidden="true" tabindex="-1"></a>  this.file.data<span class="ot">&lt;-</span> <span class="fu">subset</span>(this.file.data,<span class="sc">!</span><span class="fu">is.na</span>(Lab.Sample.Name))</span>
<span id="cb23-37"><a href="#cb23-37" aria-hidden="true" tabindex="-1"></a>  this.file.data[<span class="fu">is.na</span>(this.file.data<span class="sc">$</span>Note),<span class="st">&quot;Note&quot;</span>]<span class="ot">&lt;-</span><span class="st">&quot;&quot;</span></span>
<span id="cb23-38"><a href="#cb23-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-39"><a href="#cb23-39" aria-hidden="true" tabindex="-1"></a>  this.file.data<span class="sc">$</span>UC.Assay.T0.Conc <span class="ot">&lt;-</span> UC.ASSAY.T0.CONC</span>
<span id="cb23-40"><a href="#cb23-40" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (this.chem <span class="cf">in</span> <span class="fu">unique</span>(this.file.data<span class="sc">$</span>Lab.Compound.Name))</span>
<span id="cb23-41"><a href="#cb23-41" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb23-42"><a href="#cb23-42" aria-hidden="true" tabindex="-1"></a>    which.rows <span class="ot">&lt;-</span> this.file.data<span class="sc">$</span>Lab.Compound.Name <span class="sc">==</span> this.chem </span>
<span id="cb23-43"><a href="#cb23-43" aria-hidden="true" tabindex="-1"></a>    chem.index <span class="ot">&lt;-</span> <span class="fu">which</span>(these.chems<span class="sc">$</span><span class="st">`</span><span class="at">Sample ID</span><span class="st">`</span> <span class="sc">==</span> this.chem)</span>
<span id="cb23-44"><a href="#cb23-44" aria-hidden="true" tabindex="-1"></a><span class="co"># Get rid of column header rows:</span></span>
<span id="cb23-45"><a href="#cb23-45" aria-hidden="true" tabindex="-1"></a>    this.file.data[which.rows, <span class="st">&quot;Compound.Name&quot;</span>] <span class="ot">&lt;-</span> these.chems[</span>
<span id="cb23-46"><a href="#cb23-46" aria-hidden="true" tabindex="-1"></a>      chem.index,<span class="st">&quot;Name&quot;</span>]</span>
<span id="cb23-47"><a href="#cb23-47" aria-hidden="true" tabindex="-1"></a>    this.file.data[which.rows, <span class="st">&quot;Lab.Compound.Name&quot;</span>] <span class="ot">&lt;-</span> this.chem</span>
<span id="cb23-48"><a href="#cb23-48" aria-hidden="true" tabindex="-1"></a>    this.file.data[which.rows, <span class="st">&quot;DTXSID&quot;</span>] <span class="ot">&lt;-</span> these.chems[</span>
<span id="cb23-49"><a href="#cb23-49" aria-hidden="true" tabindex="-1"></a>      chem.index,<span class="st">&quot;Analyte&quot;</span>]</span>
<span id="cb23-50"><a href="#cb23-50" aria-hidden="true" tabindex="-1"></a>    this.file.data[which.rows, <span class="st">&quot;ISTD.Name&quot;</span>] <span class="ot">&lt;-</span> these.chems[</span>
<span id="cb23-51"><a href="#cb23-51" aria-hidden="true" tabindex="-1"></a>      chem.index,<span class="st">&quot;IS&quot;</span>]</span>
<span id="cb23-52"><a href="#cb23-52" aria-hidden="true" tabindex="-1"></a>    this.file.data[which.rows, <span class="st">&quot;ISTD.Conc&quot;</span>] <span class="ot">&lt;-</span> ISTD.CONC</span>
<span id="cb23-53"><a href="#cb23-53" aria-hidden="true" tabindex="-1"></a>    this.file.data[which.rows, <span class="st">&quot;Date&quot;</span>] <span class="ot">&lt;-</span> these.chems[</span>
<span id="cb23-54"><a href="#cb23-54" aria-hidden="true" tabindex="-1"></a>      chem.index,<span class="st">&quot;Date&quot;</span>]</span>
<span id="cb23-55"><a href="#cb23-55" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb23-56"><a href="#cb23-56" aria-hidden="true" tabindex="-1"></a>  this.file.data<span class="sc">$</span>Cal <span class="ot">&lt;-</span> this.file.data<span class="sc">$</span>Date</span>
<span id="cb23-57"><a href="#cb23-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-58"><a href="#cb23-58" aria-hidden="true" tabindex="-1"></a>  this.file.data<span class="sc">$</span>Analysis.Method <span class="ot">&lt;-</span> <span class="st">&quot;GCMS&quot;</span></span>
<span id="cb23-59"><a href="#cb23-59" aria-hidden="true" tabindex="-1"></a>  this.file.data<span class="sc">$</span>Analysis.Instrument <span class="ot">&lt;-</span> <span class="st">&quot;Agilent 8890 GC w 7010 triple quadrupole&quot;</span></span>
<span id="cb23-60"><a href="#cb23-60" aria-hidden="true" tabindex="-1"></a>  this.file.data<span class="sc">$</span>Level0.File <span class="ot">&lt;-</span> this.file</span>
<span id="cb23-61"><a href="#cb23-61" aria-hidden="true" tabindex="-1"></a>  this.file.data<span class="sc">$</span>Level0.Sheet <span class="ot">&lt;-</span> <span class="st">&quot;All Raw data and Calcs&quot;</span></span>
<span id="cb23-62"><a href="#cb23-62" aria-hidden="true" tabindex="-1"></a>  UC.data <span class="ot">&lt;-</span> <span class="fu">rbind</span>(UC.data,this.file.data[,<span class="fu">colnames</span>(UC.data)])  </span>
<span id="cb23-63"><a href="#cb23-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dim</span>(UC.data)</span></code></pre></div>
</div>
<div id="handle-the-data-for-uc_940_athens_mix1a__2020_feb.xlsx" class="section level1">
<h1>Handle the data for “UC_940_Athens_Mix1a__2020_Feb.xlsx”</h1>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>  this.file <span class="ot">&lt;-</span> <span class="st">&quot;UC_940_Athens_Mix1a__2020_Feb.xlsx&quot;</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 940</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  this.row <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Analyte=</span><span class="st">&quot;DTXSID3047558&quot;</span>,</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">Name=</span><span class="st">&quot;6:2 Fluorotelomer methacrylate&quot;</span>,</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>                       <span class="st">&quot;Sample ID&quot;</span><span class="ot">=</span><span class="st">&quot;940&quot;</span>,</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>                       <span class="at">IS=</span><span class="st">&quot;m8:2FTOH&quot;</span>,</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>                       <span class="st">&quot;Reference Compound&quot;</span><span class="ot">=</span><span class="cn">NA</span>,</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>                       <span class="st">&quot;Avg. MW&quot;</span><span class="ot">=</span><span class="fl">432.181</span>,</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>                       <span class="at">Flags=</span><span class="cn">NA</span>,</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>                       <span class="at">File=</span>this.file,</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>                       <span class="at">Date=</span><span class="st">&quot;2020-02-01&quot;</span>)</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(this.row) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(cheminfo)</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>  cheminfo <span class="ot">&lt;-</span> <span class="fu">rbind</span>(cheminfo,this.row)</span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a><span class="co"># 3203</span></span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>  this.row <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Analyte=</span><span class="st">&quot;DTXSID3065586&quot;</span>,</span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>                       <span class="at">Name=</span><span class="st">&quot;1H,1H-Perfluorobutyl methacrylate&quot;</span>,</span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>                       <span class="st">&quot;Sample ID&quot;</span><span class="ot">=</span><span class="st">&quot;3203&quot;</span>,</span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>                       <span class="at">IS=</span><span class="st">&quot;m8:2FTOH&quot;</span>,</span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>                       <span class="st">&quot;Reference Compound&quot;</span><span class="ot">=</span><span class="cn">NA</span>,</span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>                       <span class="st">&quot;Avg. MW&quot;</span><span class="ot">=</span><span class="fl">268.131</span>,</span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a>                       <span class="at">Flags=</span><span class="cn">NA</span>,</span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a>                       <span class="at">File=</span>this.file,</span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a>                       <span class="at">Date=</span><span class="st">&quot;2020-02-01&quot;</span>)</span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(this.row) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(cheminfo)</span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a>  cheminfo <span class="ot">&lt;-</span> <span class="fu">rbind</span>(cheminfo,this.row)</span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a><span class="co"># 3142</span></span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a>  this.row <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Analyte=</span><span class="st">&quot;DTXSID00194615&quot;</span>,</span>
<span id="cb24-28"><a href="#cb24-28" aria-hidden="true" tabindex="-1"></a>                       <span class="at">Name=</span><span class="st">&quot;1H,1H,9H-Perfluorononyl acrylate&quot;</span>,</span>
<span id="cb24-29"><a href="#cb24-29" aria-hidden="true" tabindex="-1"></a>                       <span class="st">&quot;Sample ID&quot;</span><span class="ot">=</span><span class="st">&quot;3142&quot;</span>,</span>
<span id="cb24-30"><a href="#cb24-30" aria-hidden="true" tabindex="-1"></a>                       <span class="at">IS=</span><span class="st">&quot;m8:2FTOH&quot;</span>,</span>
<span id="cb24-31"><a href="#cb24-31" aria-hidden="true" tabindex="-1"></a>                       <span class="st">&quot;Reference Compound&quot;</span><span class="ot">=</span><span class="cn">NA</span>,</span>
<span id="cb24-32"><a href="#cb24-32" aria-hidden="true" tabindex="-1"></a>                       <span class="st">&quot;Avg. MW&quot;</span><span class="ot">=</span><span class="fl">486.152</span>,</span>
<span id="cb24-33"><a href="#cb24-33" aria-hidden="true" tabindex="-1"></a>                       <span class="at">Flags=</span><span class="cn">NA</span>,</span>
<span id="cb24-34"><a href="#cb24-34" aria-hidden="true" tabindex="-1"></a>                       <span class="at">File=</span>this.file,</span>
<span id="cb24-35"><a href="#cb24-35" aria-hidden="true" tabindex="-1"></a>                       <span class="at">Date=</span><span class="st">&quot;2020-02-01&quot;</span>)</span>
<span id="cb24-36"><a href="#cb24-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(this.row) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(cheminfo)</span>
<span id="cb24-37"><a href="#cb24-37" aria-hidden="true" tabindex="-1"></a>  cheminfo <span class="ot">&lt;-</span> <span class="fu">rbind</span>(cheminfo,this.row)</span>
<span id="cb24-38"><a href="#cb24-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-39"><a href="#cb24-39" aria-hidden="true" tabindex="-1"></a>  these.chems <span class="ot">&lt;-</span> <span class="fu">subset</span>(cheminfo,File<span class="sc">==</span>this.file<span class="sc">|</span><span class="st">&quot;Sample ID&quot;</span><span class="sc">==</span><span class="st">&quot;4NT&quot;</span>)</span>
<span id="cb24-40"><a href="#cb24-40" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb24-41"><a href="#cb24-41" aria-hidden="true" tabindex="-1"></a>  this.sheet <span class="ot">&lt;-</span> <span class="st">&quot;Data&quot;</span></span>
<span id="cb24-42"><a href="#cb24-42" aria-hidden="true" tabindex="-1"></a>  these.data <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(</span>
<span id="cb24-43"><a href="#cb24-43" aria-hidden="true" tabindex="-1"></a>    <span class="fu">suppressMessages</span>(<span class="fu">read_excel</span>(this.file,</span>
<span id="cb24-44"><a href="#cb24-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">sheet=</span>this.sheet,</span>
<span id="cb24-45"><a href="#cb24-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">skip=</span><span class="dv">4</span>)))</span>
<span id="cb24-46"><a href="#cb24-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-47"><a href="#cb24-47" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb24-48"><a href="#cb24-48" aria-hidden="true" tabindex="-1"></a>  this.file.data <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb24-49"><a href="#cb24-49" aria-hidden="true" tabindex="-1"></a>  chem.names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;940&quot;</span>,<span class="st">&quot;3203&quot;</span>,<span class="st">&quot;3142&quot;</span>)</span>
<span id="cb24-50"><a href="#cb24-50" aria-hidden="true" tabindex="-1"></a>  chem.cols <span class="ot">&lt;-</span> <span class="fu">colnames</span>(these.data)[<span class="fu">c</span>(<span class="dv">7</span>,<span class="dv">4</span>,<span class="dv">8</span>)]</span>
<span id="cb24-51"><a href="#cb24-51" aria-hidden="true" tabindex="-1"></a>  istd.col <span class="ot">&lt;-</span> <span class="st">&quot;...6&quot;</span></span>
<span id="cb24-52"><a href="#cb24-52" aria-hidden="true" tabindex="-1"></a>  conc.col <span class="ot">&lt;-</span> <span class="st">&quot;nm after crash&quot;</span></span>
<span id="cb24-53"><a href="#cb24-53" aria-hidden="true" tabindex="-1"></a>  sample.name.col <span class="ot">&lt;-</span><span class="st">&quot;Sample Name&quot;</span></span>
<span id="cb24-54"><a href="#cb24-54" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (this.chem.index <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(chem.names))</span>
<span id="cb24-55"><a href="#cb24-55" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb24-56"><a href="#cb24-56" aria-hidden="true" tabindex="-1"></a>    this.chem <span class="ot">&lt;-</span> chem.names[this.chem.index]</span>
<span id="cb24-57"><a href="#cb24-57" aria-hidden="true" tabindex="-1"></a>    this.chem.data <span class="ot">&lt;-</span> these.data[,<span class="fu">c</span>(</span>
<span id="cb24-58"><a href="#cb24-58" aria-hidden="true" tabindex="-1"></a>      chem.cols[this.chem.index],</span>
<span id="cb24-59"><a href="#cb24-59" aria-hidden="true" tabindex="-1"></a>      istd.col,</span>
<span id="cb24-60"><a href="#cb24-60" aria-hidden="true" tabindex="-1"></a>      sample.name.col,</span>
<span id="cb24-61"><a href="#cb24-61" aria-hidden="true" tabindex="-1"></a>      conc.col</span>
<span id="cb24-62"><a href="#cb24-62" aria-hidden="true" tabindex="-1"></a>      )]</span>
<span id="cb24-63"><a href="#cb24-63" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colnames</span>(this.chem.data) <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb24-64"><a href="#cb24-64" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;Area&quot;</span>,<span class="st">&quot;ISTD.Area&quot;</span>,<span class="st">&quot;Lab.Sample.Name&quot;</span>,<span class="st">&quot;NominConc&quot;</span>)</span>
<span id="cb24-65"><a href="#cb24-65" aria-hidden="true" tabindex="-1"></a>    this.chem.data <span class="ot">&lt;-</span> <span class="fu">subset</span>(this.chem.data, <span class="sc">!</span><span class="fu">is.na</span>(<span class="fu">as.numeric</span>(Area)))</span>
<span id="cb24-66"><a href="#cb24-66" aria-hidden="true" tabindex="-1"></a>    this.chem.data<span class="sc">$</span>Lab.Compound.Name <span class="ot">&lt;-</span> this.chem</span>
<span id="cb24-67"><a href="#cb24-67" aria-hidden="true" tabindex="-1"></a>    chem.index <span class="ot">&lt;-</span> <span class="fu">which</span>(these.chems<span class="sc">$</span><span class="st">`</span><span class="at">Sample ID</span><span class="st">`</span> <span class="sc">==</span> this.chem)</span>
<span id="cb24-68"><a href="#cb24-68" aria-hidden="true" tabindex="-1"></a><span class="co"># Get rid of column header rows:t</span></span>
<span id="cb24-69"><a href="#cb24-69" aria-hidden="true" tabindex="-1"></a>    this.chem.data[, <span class="st">&quot;Compound.Name&quot;</span>] <span class="ot">&lt;-</span> these.chems[</span>
<span id="cb24-70"><a href="#cb24-70" aria-hidden="true" tabindex="-1"></a>      chem.index,<span class="st">&quot;Name&quot;</span>]</span>
<span id="cb24-71"><a href="#cb24-71" aria-hidden="true" tabindex="-1"></a>    this.chem.data[, <span class="st">&quot;Lab.Compound.Name&quot;</span>] <span class="ot">&lt;-</span> this.chem</span>
<span id="cb24-72"><a href="#cb24-72" aria-hidden="true" tabindex="-1"></a>    this.chem.data[, <span class="st">&quot;DTXSID&quot;</span>] <span class="ot">&lt;-</span> these.chems[</span>
<span id="cb24-73"><a href="#cb24-73" aria-hidden="true" tabindex="-1"></a>      chem.index,<span class="st">&quot;Analyte&quot;</span>]</span>
<span id="cb24-74"><a href="#cb24-74" aria-hidden="true" tabindex="-1"></a>    this.chem.data[, <span class="st">&quot;ISTD.Name&quot;</span>] <span class="ot">&lt;-</span> these.chems[</span>
<span id="cb24-75"><a href="#cb24-75" aria-hidden="true" tabindex="-1"></a>      chem.index,<span class="st">&quot;IS&quot;</span>]</span>
<span id="cb24-76"><a href="#cb24-76" aria-hidden="true" tabindex="-1"></a>    this.chem.data[, <span class="st">&quot;ISTD.Conc&quot;</span>] <span class="ot">&lt;-</span> ISTD.CONC</span>
<span id="cb24-77"><a href="#cb24-77" aria-hidden="true" tabindex="-1"></a>    this.chem.data[, <span class="st">&quot;Date&quot;</span>] <span class="ot">&lt;-</span> these.chems[</span>
<span id="cb24-78"><a href="#cb24-78" aria-hidden="true" tabindex="-1"></a>      chem.index,<span class="st">&quot;Date&quot;</span>]</span>
<span id="cb24-79"><a href="#cb24-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-80"><a href="#cb24-80" aria-hidden="true" tabindex="-1"></a>    this.file.data <span class="ot">&lt;-</span> <span class="fu">rbind</span>(this.file.data,this.chem.data)  </span>
<span id="cb24-81"><a href="#cb24-81" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb24-82"><a href="#cb24-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-83"><a href="#cb24-83" aria-hidden="true" tabindex="-1"></a>  this.file.data<span class="sc">$</span>UC.Assay.T0.Conc <span class="ot">&lt;-</span> UC.ASSAY.T0.CONC</span>
<span id="cb24-84"><a href="#cb24-84" aria-hidden="true" tabindex="-1"></a>  this.file.data<span class="sc">$</span>Type <span class="ot">&lt;-</span> this.chem.data<span class="sc">$</span>Lab.Sample.Name</span>
<span id="cb24-85"><a href="#cb24-85" aria-hidden="true" tabindex="-1"></a>  this.file.data<span class="sc">$</span>Note <span class="ot">&lt;-</span> <span class="st">&quot;&quot;</span></span>
<span id="cb24-86"><a href="#cb24-86" aria-hidden="true" tabindex="-1"></a>  this.file.data<span class="sc">$</span>Cal <span class="ot">&lt;-</span> this.file.data<span class="sc">$</span>Date</span>
<span id="cb24-87"><a href="#cb24-87" aria-hidden="true" tabindex="-1"></a>  this.file.data<span class="sc">$</span>Analysis.Parameters<span class="ot">&lt;-</span><span class="st">&quot;&quot;</span></span>
<span id="cb24-88"><a href="#cb24-88" aria-hidden="true" tabindex="-1"></a>  this.file.data<span class="sc">$</span>Level0.Sheet <span class="ot">&lt;-</span> this.sheet</span>
<span id="cb24-89"><a href="#cb24-89" aria-hidden="true" tabindex="-1"></a>  this.file.data<span class="sc">$</span>Analysis.Method <span class="ot">&lt;-</span> <span class="st">&quot;GCMS&quot;</span></span>
<span id="cb24-90"><a href="#cb24-90" aria-hidden="true" tabindex="-1"></a>  this.file.data<span class="sc">$</span>Analysis.Instrument <span class="ot">&lt;-</span> <span class="st">&quot;Agilent 7890 GC w 7010 triple quadrupole&quot;</span></span>
<span id="cb24-91"><a href="#cb24-91" aria-hidden="true" tabindex="-1"></a>  this.file.data<span class="sc">$</span>Level0.File <span class="ot">&lt;-</span> this.file</span>
<span id="cb24-92"><a href="#cb24-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-93"><a href="#cb24-93" aria-hidden="true" tabindex="-1"></a>  UC.data <span class="ot">&lt;-</span> <span class="fu">rbind</span>(UC.data,this.file.data[,<span class="fu">colnames</span>(UC.data)])  </span>
<span id="cb24-94"><a href="#cb24-94" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dim</span>(UC.data)</span></code></pre></div>
</div>
<div id="handle-the-data-for-uc_276_467_athens_mix-2a-and-b20220913.xlsx" class="section level1">
<h1>Handle the data for “UC_276_467_Athens_Mix 2a and
b20220913.xlsx”</h1>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>  this.file <span class="ot">&lt;-</span> <span class="st">&quot;UC_276_467_Athens_Mix 2a and b20220913.xlsx&quot;</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 276</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  this.row <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Analyte=</span><span class="st">&quot;DTXSID5063235&quot;</span>,</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">Name=</span><span class="st">&quot;1H,1H-Perfluorooctyl methacrylate&quot;</span>,</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>                       <span class="st">&quot;Sample ID&quot;</span><span class="ot">=</span><span class="st">&quot;276&quot;</span>,</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>                       <span class="at">IS=</span><span class="st">&quot;m6:2FTOH&quot;</span>,</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>                       <span class="st">&quot;Reference Compound&quot;</span><span class="ot">=</span><span class="cn">NA</span>,</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>                       <span class="st">&quot;Avg. MW&quot;</span><span class="ot">=</span><span class="fl">468.162</span>,</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>                       <span class="at">Flags=</span><span class="cn">NA</span>,</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>                       <span class="at">File=</span>this.file,</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>                       <span class="at">Date=</span><span class="st">&quot;2020-02-01&quot;</span>)</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(this.row) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(cheminfo)</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>  cheminfo <span class="ot">&lt;-</span> <span class="fu">rbind</span>(cheminfo,this.row)</span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a><span class="co"># 467</span></span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>  this.row <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Analyte=</span><span class="st">&quot;DTXSID8062101&quot;</span>,</span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>                       <span class="at">Name=</span><span class="st">&quot;8:2 Fluorotelomer methacrylate&quot;</span>,</span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>                       <span class="st">&quot;Sample ID&quot;</span><span class="ot">=</span><span class="st">&quot;467&quot;</span>,</span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>                       <span class="at">IS=</span><span class="st">&quot;m6:2FTOH&quot;</span>,</span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>                       <span class="st">&quot;Reference Compound&quot;</span><span class="ot">=</span><span class="cn">NA</span>,</span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a>                       <span class="st">&quot;Avg. MW&quot;</span><span class="ot">=</span><span class="fl">532.197</span>,</span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a>                       <span class="at">Flags=</span><span class="cn">NA</span>,</span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a>                       <span class="at">File=</span>this.file,</span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a>                       <span class="at">Date=</span><span class="st">&quot;2020-02-01&quot;</span>)</span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(this.row) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(cheminfo)</span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a>  cheminfo <span class="ot">&lt;-</span> <span class="fu">rbind</span>(cheminfo,this.row)</span>
<span id="cb25-27"><a href="#cb25-27" aria-hidden="true" tabindex="-1"></a><span class="co"># 471</span></span>
<span id="cb25-28"><a href="#cb25-28" aria-hidden="true" tabindex="-1"></a>  this.row <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Analyte=</span><span class="st">&quot;DTXSID10224331&quot;</span>,</span>
<span id="cb25-29"><a href="#cb25-29" aria-hidden="true" tabindex="-1"></a>                       <span class="at">Name=</span><span class="st">&quot;2,2,3,3-Tetrafluoropropyl acrylate&quot;</span>,</span>
<span id="cb25-30"><a href="#cb25-30" aria-hidden="true" tabindex="-1"></a>                       <span class="st">&quot;Sample ID&quot;</span><span class="ot">=</span><span class="st">&quot;471&quot;</span>,</span>
<span id="cb25-31"><a href="#cb25-31" aria-hidden="true" tabindex="-1"></a>                       <span class="at">IS=</span><span class="st">&quot;m6:2FTOH&quot;</span>,</span>
<span id="cb25-32"><a href="#cb25-32" aria-hidden="true" tabindex="-1"></a>                       <span class="st">&quot;Reference Compound&quot;</span><span class="ot">=</span><span class="cn">NA</span>,</span>
<span id="cb25-33"><a href="#cb25-33" aria-hidden="true" tabindex="-1"></a>                       <span class="st">&quot;Avg. MW&quot;</span><span class="ot">=</span><span class="fl">186.106</span>,</span>
<span id="cb25-34"><a href="#cb25-34" aria-hidden="true" tabindex="-1"></a>                       <span class="at">Flags=</span><span class="cn">NA</span>,</span>
<span id="cb25-35"><a href="#cb25-35" aria-hidden="true" tabindex="-1"></a>                       <span class="at">File=</span>this.file,</span>
<span id="cb25-36"><a href="#cb25-36" aria-hidden="true" tabindex="-1"></a>                       <span class="at">Date=</span><span class="st">&quot;2020-02-01&quot;</span>)</span>
<span id="cb25-37"><a href="#cb25-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(this.row) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(cheminfo)</span>
<span id="cb25-38"><a href="#cb25-38" aria-hidden="true" tabindex="-1"></a>  cheminfo <span class="ot">&lt;-</span> <span class="fu">rbind</span>(cheminfo,this.row)    </span>
<span id="cb25-39"><a href="#cb25-39" aria-hidden="true" tabindex="-1"></a><span class="co"># 478</span></span>
<span id="cb25-40"><a href="#cb25-40" aria-hidden="true" tabindex="-1"></a>  this.row <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Analyte=</span><span class="st">&quot;DTXSID1068772&quot;</span>,</span>
<span id="cb25-41"><a href="#cb25-41" aria-hidden="true" tabindex="-1"></a>                       <span class="at">Name=</span><span class="st">&quot;2-(Perfluorobutyl)ethyl acrylate&quot;</span>,</span>
<span id="cb25-42"><a href="#cb25-42" aria-hidden="true" tabindex="-1"></a>                       <span class="st">&quot;Sample ID&quot;</span><span class="ot">=</span><span class="st">&quot;478&quot;</span>,</span>
<span id="cb25-43"><a href="#cb25-43" aria-hidden="true" tabindex="-1"></a>                       <span class="at">IS=</span><span class="st">&quot;m6:2FTOH&quot;</span>,</span>
<span id="cb25-44"><a href="#cb25-44" aria-hidden="true" tabindex="-1"></a>                       <span class="st">&quot;Reference Compound&quot;</span><span class="ot">=</span><span class="cn">NA</span>,</span>
<span id="cb25-45"><a href="#cb25-45" aria-hidden="true" tabindex="-1"></a>                       <span class="st">&quot;Avg. MW&quot;</span><span class="ot">=</span><span class="fl">318.139</span>,</span>
<span id="cb25-46"><a href="#cb25-46" aria-hidden="true" tabindex="-1"></a>                       <span class="at">Flags=</span><span class="cn">NA</span>,</span>
<span id="cb25-47"><a href="#cb25-47" aria-hidden="true" tabindex="-1"></a>                       <span class="at">File=</span>this.file,</span>
<span id="cb25-48"><a href="#cb25-48" aria-hidden="true" tabindex="-1"></a>                       <span class="at">Date=</span><span class="st">&quot;2020-02-01&quot;</span>)</span>
<span id="cb25-49"><a href="#cb25-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(this.row) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(cheminfo)</span>
<span id="cb25-50"><a href="#cb25-50" aria-hidden="true" tabindex="-1"></a>  cheminfo <span class="ot">&lt;-</span> <span class="fu">rbind</span>(cheminfo,this.row)</span>
<span id="cb25-51"><a href="#cb25-51" aria-hidden="true" tabindex="-1"></a><span class="co"># 468</span></span>
<span id="cb25-52"><a href="#cb25-52" aria-hidden="true" tabindex="-1"></a>  this.row <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Analyte=</span><span class="st">&quot;DTXSID5060986&quot;</span>,</span>
<span id="cb25-53"><a href="#cb25-53" aria-hidden="true" tabindex="-1"></a>                       <span class="at">Name=</span><span class="st">&quot;1H,1H,5H,5H-Perfluoro-1,5-pentanediol diacrylate&quot;</span>,</span>
<span id="cb25-54"><a href="#cb25-54" aria-hidden="true" tabindex="-1"></a>                       <span class="st">&quot;Sample ID&quot;</span><span class="ot">=</span><span class="st">&quot;468&quot;</span>,</span>
<span id="cb25-55"><a href="#cb25-55" aria-hidden="true" tabindex="-1"></a>                       <span class="at">IS=</span><span class="st">&quot;m6:2FTOH&quot;</span>,</span>
<span id="cb25-56"><a href="#cb25-56" aria-hidden="true" tabindex="-1"></a>                       <span class="st">&quot;Reference Compound&quot;</span><span class="ot">=</span><span class="cn">NA</span>,</span>
<span id="cb25-57"><a href="#cb25-57" aria-hidden="true" tabindex="-1"></a>                       <span class="st">&quot;Avg. MW&quot;</span><span class="ot">=</span><span class="fl">320.187</span>,</span>
<span id="cb25-58"><a href="#cb25-58" aria-hidden="true" tabindex="-1"></a>                       <span class="at">Flags=</span><span class="cn">NA</span>,</span>
<span id="cb25-59"><a href="#cb25-59" aria-hidden="true" tabindex="-1"></a>                       <span class="at">File=</span>this.file,</span>
<span id="cb25-60"><a href="#cb25-60" aria-hidden="true" tabindex="-1"></a>                       <span class="at">Date=</span><span class="st">&quot;2020-02-01&quot;</span>)</span>
<span id="cb25-61"><a href="#cb25-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(this.row) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(cheminfo)</span>
<span id="cb25-62"><a href="#cb25-62" aria-hidden="true" tabindex="-1"></a>  cheminfo <span class="ot">&lt;-</span> <span class="fu">rbind</span>(cheminfo,this.row) </span>
<span id="cb25-63"><a href="#cb25-63" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb25-64"><a href="#cb25-64" aria-hidden="true" tabindex="-1"></a>  these.chems <span class="ot">&lt;-</span> <span class="fu">subset</span>(cheminfo,File<span class="sc">==</span>this.file<span class="sc">|</span><span class="st">&quot;Sample ID&quot;</span><span class="sc">==</span><span class="st">&quot;4NT&quot;</span>)</span>
<span id="cb25-65"><a href="#cb25-65" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb25-66"><a href="#cb25-66" aria-hidden="true" tabindex="-1"></a>  this.sheet <span class="ot">&lt;-</span> <span class="st">&quot;Sheet 1_Mix 2a and b&quot;</span></span>
<span id="cb25-67"><a href="#cb25-67" aria-hidden="true" tabindex="-1"></a>  these.data <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(</span>
<span id="cb25-68"><a href="#cb25-68" aria-hidden="true" tabindex="-1"></a>    <span class="fu">suppressMessages</span>(<span class="fu">read_excel</span>(this.file,</span>
<span id="cb25-69"><a href="#cb25-69" aria-hidden="true" tabindex="-1"></a>    <span class="at">sheet=</span>this.sheet,</span>
<span id="cb25-70"><a href="#cb25-70" aria-hidden="true" tabindex="-1"></a>    <span class="at">skip=</span><span class="dv">3</span>)))</span>
<span id="cb25-71"><a href="#cb25-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-72"><a href="#cb25-72" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb25-73"><a href="#cb25-73" aria-hidden="true" tabindex="-1"></a>  this.file.data <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb25-74"><a href="#cb25-74" aria-hidden="true" tabindex="-1"></a>  chem.names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;471&quot;</span>,<span class="st">&quot;478&quot;</span>,<span class="st">&quot;468&quot;</span>,<span class="st">&quot;276&quot;</span>,<span class="st">&quot;467&quot;</span>)</span>
<span id="cb25-75"><a href="#cb25-75" aria-hidden="true" tabindex="-1"></a>  chem.cols <span class="ot">&lt;-</span> <span class="fu">colnames</span>(these.data)[<span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">9</span>,<span class="dv">10</span>)]</span>
<span id="cb25-76"><a href="#cb25-76" aria-hidden="true" tabindex="-1"></a>  istd.col <span class="ot">&lt;-</span> <span class="st">&quot;8.4&quot;</span></span>
<span id="cb25-77"><a href="#cb25-77" aria-hidden="true" tabindex="-1"></a>  conc.col <span class="ot">&lt;-</span> <span class="st">&quot;nm after crash&quot;</span></span>
<span id="cb25-78"><a href="#cb25-78" aria-hidden="true" tabindex="-1"></a>  sample.name.col <span class="ot">&lt;-</span><span class="st">&quot;RT&quot;</span></span>
<span id="cb25-79"><a href="#cb25-79" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (this.chem.index <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(chem.names))</span>
<span id="cb25-80"><a href="#cb25-80" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb25-81"><a href="#cb25-81" aria-hidden="true" tabindex="-1"></a>    this.chem <span class="ot">&lt;-</span> chem.names[this.chem.index]</span>
<span id="cb25-82"><a href="#cb25-82" aria-hidden="true" tabindex="-1"></a>    this.chem.data <span class="ot">&lt;-</span> these.data[,<span class="fu">c</span>(</span>
<span id="cb25-83"><a href="#cb25-83" aria-hidden="true" tabindex="-1"></a>      chem.cols[this.chem.index],</span>
<span id="cb25-84"><a href="#cb25-84" aria-hidden="true" tabindex="-1"></a>      istd.col,</span>
<span id="cb25-85"><a href="#cb25-85" aria-hidden="true" tabindex="-1"></a>      sample.name.col,</span>
<span id="cb25-86"><a href="#cb25-86" aria-hidden="true" tabindex="-1"></a>      conc.col</span>
<span id="cb25-87"><a href="#cb25-87" aria-hidden="true" tabindex="-1"></a>      )]</span>
<span id="cb25-88"><a href="#cb25-88" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colnames</span>(this.chem.data) <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb25-89"><a href="#cb25-89" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;Area&quot;</span>,<span class="st">&quot;ISTD.Area&quot;</span>,<span class="st">&quot;Lab.Sample.Name&quot;</span>,<span class="st">&quot;NominConc&quot;</span>)</span>
<span id="cb25-90"><a href="#cb25-90" aria-hidden="true" tabindex="-1"></a>    this.chem.data <span class="ot">&lt;-</span> <span class="fu">subset</span>(this.chem.data, <span class="sc">!</span><span class="fu">is.na</span>(<span class="fu">as.numeric</span>(Area)))</span>
<span id="cb25-91"><a href="#cb25-91" aria-hidden="true" tabindex="-1"></a>    this.chem.data<span class="sc">$</span>Lab.Compound.Name <span class="ot">&lt;-</span> this.chem</span>
<span id="cb25-92"><a href="#cb25-92" aria-hidden="true" tabindex="-1"></a>    chem.index <span class="ot">&lt;-</span> <span class="fu">which</span>(these.chems<span class="sc">$</span><span class="st">`</span><span class="at">Sample ID</span><span class="st">`</span> <span class="sc">==</span> this.chem)</span>
<span id="cb25-93"><a href="#cb25-93" aria-hidden="true" tabindex="-1"></a><span class="co"># Get rid of column header rows:t</span></span>
<span id="cb25-94"><a href="#cb25-94" aria-hidden="true" tabindex="-1"></a>    this.chem.data[, <span class="st">&quot;Compound.Name&quot;</span>] <span class="ot">&lt;-</span> these.chems[</span>
<span id="cb25-95"><a href="#cb25-95" aria-hidden="true" tabindex="-1"></a>      chem.index,<span class="st">&quot;Name&quot;</span>]</span>
<span id="cb25-96"><a href="#cb25-96" aria-hidden="true" tabindex="-1"></a>    this.chem.data[, <span class="st">&quot;Lab.Compound.Name&quot;</span>] <span class="ot">&lt;-</span> this.chem</span>
<span id="cb25-97"><a href="#cb25-97" aria-hidden="true" tabindex="-1"></a>    this.chem.data[, <span class="st">&quot;DTXSID&quot;</span>] <span class="ot">&lt;-</span> these.chems[</span>
<span id="cb25-98"><a href="#cb25-98" aria-hidden="true" tabindex="-1"></a>      chem.index,<span class="st">&quot;Analyte&quot;</span>]</span>
<span id="cb25-99"><a href="#cb25-99" aria-hidden="true" tabindex="-1"></a>    this.chem.data[, <span class="st">&quot;ISTD.Name&quot;</span>] <span class="ot">&lt;-</span> these.chems[</span>
<span id="cb25-100"><a href="#cb25-100" aria-hidden="true" tabindex="-1"></a>      chem.index,<span class="st">&quot;IS&quot;</span>]</span>
<span id="cb25-101"><a href="#cb25-101" aria-hidden="true" tabindex="-1"></a>    this.chem.data[, <span class="st">&quot;ISTD.Conc&quot;</span>] <span class="ot">&lt;-</span> ISTD.CONC</span>
<span id="cb25-102"><a href="#cb25-102" aria-hidden="true" tabindex="-1"></a>    this.chem.data[, <span class="st">&quot;Date&quot;</span>] <span class="ot">&lt;-</span> these.chems[</span>
<span id="cb25-103"><a href="#cb25-103" aria-hidden="true" tabindex="-1"></a>      chem.index,<span class="st">&quot;Date&quot;</span>]</span>
<span id="cb25-104"><a href="#cb25-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-105"><a href="#cb25-105" aria-hidden="true" tabindex="-1"></a>    this.file.data <span class="ot">&lt;-</span> <span class="fu">rbind</span>(this.file.data,this.chem.data)  </span>
<span id="cb25-106"><a href="#cb25-106" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb25-107"><a href="#cb25-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-108"><a href="#cb25-108" aria-hidden="true" tabindex="-1"></a>  this.file.data<span class="sc">$</span>UC.Assay.T0.Conc <span class="ot">&lt;-</span> UC.ASSAY.T0.CONC</span>
<span id="cb25-109"><a href="#cb25-109" aria-hidden="true" tabindex="-1"></a>  this.file.data<span class="sc">$</span>Type <span class="ot">&lt;-</span> this.chem.data<span class="sc">$</span>Lab.Sample.Name</span>
<span id="cb25-110"><a href="#cb25-110" aria-hidden="true" tabindex="-1"></a>  this.file.data<span class="sc">$</span>Note <span class="ot">&lt;-</span> <span class="st">&quot;&quot;</span></span>
<span id="cb25-111"><a href="#cb25-111" aria-hidden="true" tabindex="-1"></a>  this.file.data<span class="sc">$</span>Cal <span class="ot">&lt;-</span> this.file.data<span class="sc">$</span>Date</span>
<span id="cb25-112"><a href="#cb25-112" aria-hidden="true" tabindex="-1"></a>  this.file.data<span class="sc">$</span>Analysis.Parameters<span class="ot">&lt;-</span><span class="st">&quot;&quot;</span></span>
<span id="cb25-113"><a href="#cb25-113" aria-hidden="true" tabindex="-1"></a>  this.file.data<span class="sc">$</span>Level0.Sheet <span class="ot">&lt;-</span> this.sheet</span>
<span id="cb25-114"><a href="#cb25-114" aria-hidden="true" tabindex="-1"></a>  this.file.data<span class="sc">$</span>Analysis.Method <span class="ot">&lt;-</span> <span class="st">&quot;GCMS&quot;</span></span>
<span id="cb25-115"><a href="#cb25-115" aria-hidden="true" tabindex="-1"></a>  this.file.data<span class="sc">$</span>Analysis.Instrument <span class="ot">&lt;-</span> <span class="st">&quot;Agilent 7890 GC w 7010 triple quadrupole&quot;</span></span>
<span id="cb25-116"><a href="#cb25-116" aria-hidden="true" tabindex="-1"></a>  this.file.data<span class="sc">$</span>Level0.File <span class="ot">&lt;-</span> this.file</span>
<span id="cb25-117"><a href="#cb25-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-118"><a href="#cb25-118" aria-hidden="true" tabindex="-1"></a>  UC.data <span class="ot">&lt;-</span> <span class="fu">rbind</span>(UC.data,this.file.data[,<span class="fu">colnames</span>(UC.data)])  </span>
<span id="cb25-119"><a href="#cb25-119" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dim</span>(UC.data)</span></code></pre></div>
</div>
<div id="load-uc-data-collected-by-lucas" class="section level1">
<h1>Load UC data collected by Lucas:</h1>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>data.guide <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">read_excel</span>(<span class="st">&quot;dataguide-LA-UC.xlsx&quot;</span>))</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>new.row <span class="ot">&lt;-</span> cheminfo[<span class="dv">1</span>,]</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>new.row[<span class="dv">1</span>,] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>new.row[<span class="dv">1</span>,<span class="st">&quot;Sample ID&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;3203&quot;</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>new.row[<span class="dv">1</span>,<span class="st">&quot;Name&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;1H,1H-Perfluorobutyl methacrylate&quot;</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>cheminfo <span class="ot">&lt;-</span> <span class="fu">rbind</span>(cheminfo,new.row)</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>la.uc <span class="ot">&lt;-</span> <span class="fu">merge_level0</span>(<span class="at">data.label=</span><span class="st">&quot;KreutzPFASHep&quot;</span>,</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a><span class="co"># describe the MS data table:</span></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">level0.catalog=</span>data.guide,</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>             <span class="at">sample.colname=</span><span class="st">&quot;Name&quot;</span>,</span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>             <span class="at">type.colname=</span><span class="st">&quot;Type&quot;</span>,</span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>             <span class="at">istd.col=</span><span class="st">&quot;ISTD.Name&quot;</span>,</span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>             <span class="at">analysis.param.colname.col=</span><span class="st">&quot;Note.ColName&quot;</span>,</span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a><span class="co"># describe the chemical ID table:</span></span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>             <span class="at">chem.ids=</span>cheminfo,</span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>             <span class="at">chem.lab.id.col=</span><span class="st">&quot;Sample ID&quot;</span>,</span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>             <span class="at">chem.name.col=</span><span class="st">&quot;Name&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Try again to get rid of column header rows:</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  UC.data <span class="ot">&lt;-</span> <span class="fu">subset</span>(UC.data,Type<span class="sc">!=</span><span class="st">&quot;Type&quot;</span>)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dim</span>(UC.data)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Make the peak area numeric and set a reasonable precision:</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>  UC.data<span class="sc">$</span>Area <span class="ot">&lt;-</span> <span class="fu">signif</span>(</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">suppressWarnings</span>(<span class="fu">as.numeric</span>(UC.data<span class="sc">$</span>Area)))</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>  UC.data<span class="sc">$</span>ISTD.Area <span class="ot">&lt;-</span> <span class="fu">signif</span>(</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">suppressWarnings</span>(<span class="fu">as.numeric</span>(UC.data<span class="sc">$</span>ISTD.Area)))</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Annotate instrument:</span></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a> UC.data<span class="sc">$</span>Analysis.Method <span class="ot">&lt;-</span> ANALYSIS.METHOD</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>  UC.data<span class="sc">$</span>Analysis.Instrument <span class="ot">&lt;-</span> ANALYSIS.INSTRUMENT</span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract the sample type from column Sample Text:</span></span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (this.replicate <span class="cf">in</span> <span class="fu">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>,<span class="st">&quot;c&quot;</span>))</span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (this.type <span class="cf">in</span> <span class="fu">c</span>(<span class="st">&quot;T1&quot;</span>,<span class="st">&quot;T5&quot;</span>,<span class="st">&quot;AF&quot;</span>))</span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a>      this.string <span class="ot">&lt;-</span> <span class="fu">paste</span>(this.type,this.replicate,<span class="at">sep=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a>      which.rows <span class="ot">&lt;-</span> <span class="fu">regexpr</span>(<span class="fu">tolower</span>(this.string),</span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">tolower</span>(<span class="fu">unlist</span>(UC.data[,<span class="st">&quot;Lab.Sample.Name&quot;</span>])))<span class="sc">!=-</span><span class="dv">1</span></span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a>      which.rows <span class="ot">&lt;-</span> which.rows <span class="sc">|</span> <span class="fu">regexpr</span>(<span class="fu">tolower</span>(this.string),</span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">tolower</span>(<span class="fu">unlist</span>(UC.data[,<span class="st">&quot;Type&quot;</span>])))<span class="sc">!=-</span><span class="dv">1</span></span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a>      UC.data[which.rows, <span class="st">&quot;Sample.Type&quot;</span>] <span class="ot">&lt;-</span> this.type</span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true" tabindex="-1"></a>      UC.data[which.rows, <span class="st">&quot;Replicate&quot;</span>] <span class="ot">&lt;-</span> this.replicate</span>
<span id="cb27-26"><a href="#cb27-26" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb27-27"><a href="#cb27-27" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span> (this.series <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)</span>
<span id="cb27-28"><a href="#cb27-28" aria-hidden="true" tabindex="-1"></a>      {</span>
<span id="cb27-29"><a href="#cb27-29" aria-hidden="true" tabindex="-1"></a>        this.string <span class="ot">&lt;-</span> <span class="fu">paste</span>(this.type,<span class="st">&quot; S&quot;</span>,this.series,this.replicate,<span class="at">sep=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb27-30"><a href="#cb27-30" aria-hidden="true" tabindex="-1"></a>        which.rows <span class="ot">&lt;-</span> <span class="fu">regexpr</span>(<span class="fu">tolower</span>(this.string),</span>
<span id="cb27-31"><a href="#cb27-31" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">tolower</span>(<span class="fu">unlist</span>(UC.data[,<span class="st">&quot;Lab.Sample.Name&quot;</span>])))<span class="sc">!=-</span><span class="dv">1</span></span>
<span id="cb27-32"><a href="#cb27-32" aria-hidden="true" tabindex="-1"></a>        which.rows <span class="ot">&lt;-</span> which.rows <span class="sc">|</span> <span class="fu">regexpr</span>(<span class="fu">tolower</span>(this.string),</span>
<span id="cb27-33"><a href="#cb27-33" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">tolower</span>(<span class="fu">unlist</span>(UC.data[,<span class="st">&quot;Type&quot;</span>])))<span class="sc">!=-</span><span class="dv">1</span></span>
<span id="cb27-34"><a href="#cb27-34" aria-hidden="true" tabindex="-1"></a>        UC.data[which.rows, <span class="st">&quot;Sample.Type&quot;</span>] <span class="ot">&lt;-</span> this.type</span>
<span id="cb27-35"><a href="#cb27-35" aria-hidden="true" tabindex="-1"></a>        UC.data[which.rows, <span class="st">&quot;Replicate&quot;</span>] <span class="ot">&lt;-</span> this.replicate</span>
<span id="cb27-36"><a href="#cb27-36" aria-hidden="true" tabindex="-1"></a>        UC.data[which.rows, <span class="st">&quot;Series&quot;</span>] <span class="ot">&lt;-</span> this.series</span>
<span id="cb27-37"><a href="#cb27-37" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb27-38"><a href="#cb27-38" aria-hidden="true" tabindex="-1"></a>        this.string <span class="ot">&lt;-</span> <span class="fu">paste</span>(this.type,<span class="st">&quot;S&quot;</span>,this.series,this.replicate,<span class="at">sep=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb27-39"><a href="#cb27-39" aria-hidden="true" tabindex="-1"></a>        which.rows <span class="ot">&lt;-</span> <span class="fu">regexpr</span>(<span class="fu">tolower</span>(this.string),</span>
<span id="cb27-40"><a href="#cb27-40" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">tolower</span>(<span class="fu">unlist</span>(UC.data[,<span class="st">&quot;Lab.Sample.Name&quot;</span>])))<span class="sc">!=-</span><span class="dv">1</span></span>
<span id="cb27-41"><a href="#cb27-41" aria-hidden="true" tabindex="-1"></a>        which.rows <span class="ot">&lt;-</span> which.rows <span class="sc">|</span> <span class="fu">regexpr</span>(<span class="fu">tolower</span>(this.string),</span>
<span id="cb27-42"><a href="#cb27-42" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">tolower</span>(<span class="fu">unlist</span>(UC.data[,<span class="st">&quot;Type&quot;</span>])))<span class="sc">!=-</span><span class="dv">1</span></span>
<span id="cb27-43"><a href="#cb27-43" aria-hidden="true" tabindex="-1"></a>        UC.data[which.rows, <span class="st">&quot;Sample.Type&quot;</span>] <span class="ot">&lt;-</span> this.type</span>
<span id="cb27-44"><a href="#cb27-44" aria-hidden="true" tabindex="-1"></a>        UC.data[which.rows, <span class="st">&quot;Replicate&quot;</span>] <span class="ot">&lt;-</span> this.replicate</span>
<span id="cb27-45"><a href="#cb27-45" aria-hidden="true" tabindex="-1"></a>        UC.data[which.rows, <span class="st">&quot;Series&quot;</span>] <span class="ot">&lt;-</span> this.series</span>
<span id="cb27-46"><a href="#cb27-46" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb27-47"><a href="#cb27-47" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb27-48"><a href="#cb27-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-49"><a href="#cb27-49" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Annotate series:</span></span>
<span id="cb27-50"><a href="#cb27-50" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (this.series <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)</span>
<span id="cb27-51"><a href="#cb27-51" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb27-52"><a href="#cb27-52" aria-hidden="true" tabindex="-1"></a>    this.string <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;S&quot;</span>,this.series,<span class="at">sep=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb27-53"><a href="#cb27-53" aria-hidden="true" tabindex="-1"></a>    which.rows <span class="ot">&lt;-</span> <span class="fu">regexpr</span>(this.string, <span class="fu">unlist</span>(UC.data[,<span class="st">&quot;Lab.Sample.Name&quot;</span>]))<span class="sc">!=-</span><span class="dv">1</span></span>
<span id="cb27-54"><a href="#cb27-54" aria-hidden="true" tabindex="-1"></a>    UC.data[which.rows, <span class="st">&quot;Series&quot;</span>] <span class="ot">&lt;-</span> this.series</span>
<span id="cb27-55"><a href="#cb27-55" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb27-56"><a href="#cb27-56" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb27-57"><a href="#cb27-57" aria-hidden="true" tabindex="-1"></a>  UC.data[UC.data<span class="sc">$</span>Type <span class="sc">==</span> <span class="st">&quot;Cal&quot;</span>,<span class="st">&quot;Sample.Type&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;CC&quot;</span></span>
<span id="cb27-58"><a href="#cb27-58" aria-hidden="true" tabindex="-1"></a>  which.rows <span class="ot">&lt;-</span> <span class="fu">regexpr</span>(<span class="st">&quot;cc&quot;</span>,</span>
<span id="cb27-59"><a href="#cb27-59" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">tolower</span>(<span class="fu">unlist</span>(UC.data[,<span class="st">&quot;Lab.Sample.Name&quot;</span>])))<span class="sc">!=-</span><span class="dv">1</span></span>
<span id="cb27-60"><a href="#cb27-60" aria-hidden="true" tabindex="-1"></a>  which.rows <span class="ot">&lt;-</span> which.rows <span class="sc">|</span> <span class="fu">regexpr</span>(<span class="st">&quot;cc&quot;</span>,</span>
<span id="cb27-61"><a href="#cb27-61" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">tolower</span>(<span class="fu">unlist</span>(UC.data[,<span class="st">&quot;Type&quot;</span>])))<span class="sc">!=-</span><span class="dv">1</span></span>
<span id="cb27-62"><a href="#cb27-62" aria-hidden="true" tabindex="-1"></a>  UC.data[which.rows,<span class="st">&quot;Sample.Type&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;CC&quot;</span></span>
<span id="cb27-63"><a href="#cb27-63" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-64"><a href="#cb27-64" aria-hidden="true" tabindex="-1"></a>  UC.data[UC.data<span class="sc">$</span>Type <span class="sc">==</span> <span class="st">&quot;MatrixBlank&quot;</span>,<span class="st">&quot;Sample.Type&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Blank&quot;</span></span>
<span id="cb27-65"><a href="#cb27-65" aria-hidden="true" tabindex="-1"></a>  which.rows <span class="ot">&lt;-</span> <span class="fu">regexpr</span>(<span class="st">&quot;mb&quot;</span>,</span>
<span id="cb27-66"><a href="#cb27-66" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">tolower</span>(<span class="fu">unlist</span>(UC.data[,<span class="st">&quot;Lab.Sample.Name&quot;</span>])))<span class="sc">!=-</span><span class="dv">1</span></span>
<span id="cb27-67"><a href="#cb27-67" aria-hidden="true" tabindex="-1"></a>  which.rows <span class="ot">&lt;-</span> which.rows <span class="sc">|</span> <span class="fu">regexpr</span>(<span class="st">&quot;mb&quot;</span>,</span>
<span id="cb27-68"><a href="#cb27-68" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">tolower</span>(<span class="fu">unlist</span>(UC.data[,<span class="st">&quot;Type&quot;</span>])))<span class="sc">!=-</span><span class="dv">1</span></span>
<span id="cb27-69"><a href="#cb27-69" aria-hidden="true" tabindex="-1"></a>  UC.data[which.rows,<span class="st">&quot;Sample.Type&quot;</span>] <span class="ot">&lt;-</span>  <span class="st">&quot;Blank&quot;</span></span>
<span id="cb27-70"><a href="#cb27-70" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-71"><a href="#cb27-71" aria-hidden="true" tabindex="-1"></a><span class="co"># Other Blank data:</span></span>
<span id="cb27-72"><a href="#cb27-72" aria-hidden="true" tabindex="-1"></a>  which.rows <span class="ot">&lt;-</span> <span class="fu">regexpr</span>(<span class="st">&quot;blank&quot;</span>,</span>
<span id="cb27-73"><a href="#cb27-73" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">tolower</span>(<span class="fu">unlist</span>(UC.data[,<span class="st">&quot;Lab.Sample.Name&quot;</span>])))<span class="sc">!=-</span><span class="dv">1</span> <span class="sc">&amp;</span></span>
<span id="cb27-74"><a href="#cb27-74" aria-hidden="true" tabindex="-1"></a>                <span class="fu">is.na</span>(<span class="fu">unlist</span>(UC.data[,<span class="st">&quot;Sample.Type&quot;</span>]))</span>
<span id="cb27-75"><a href="#cb27-75" aria-hidden="true" tabindex="-1"></a>  UC.data[which.rows,<span class="st">&quot;Sample.Type&quot;</span>] <span class="ot">&lt;-</span>  <span class="st">&quot;CC&quot;</span></span>
<span id="cb27-76"><a href="#cb27-76" aria-hidden="true" tabindex="-1"></a>  UC.data[which.rows, <span class="st">&quot;Series&quot;</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb27-77"><a href="#cb27-77" aria-hidden="true" tabindex="-1"></a>  UC.data[which.rows, <span class="st">&quot;NominConc&quot;</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb27-78"><a href="#cb27-78" aria-hidden="true" tabindex="-1"></a><span class="co"># Other AF data:</span></span>
<span id="cb27-79"><a href="#cb27-79" aria-hidden="true" tabindex="-1"></a>  which.rows <span class="ot">&lt;-</span> <span class="fu">regexpr</span>(<span class="st">&quot;aq&quot;</span>,</span>
<span id="cb27-80"><a href="#cb27-80" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">tolower</span>(<span class="fu">unlist</span>(UC.data[,<span class="st">&quot;Lab.Sample.Name&quot;</span>])))<span class="sc">!=-</span><span class="dv">1</span> <span class="sc">&amp;</span></span>
<span id="cb27-81"><a href="#cb27-81" aria-hidden="true" tabindex="-1"></a>                <span class="fu">is.na</span>(<span class="fu">unlist</span>(UC.data[,<span class="st">&quot;Sample.Type&quot;</span>]))</span>
<span id="cb27-82"><a href="#cb27-82" aria-hidden="true" tabindex="-1"></a>  UC.data[which.rows,<span class="st">&quot;Sample.Type&quot;</span>] <span class="ot">&lt;-</span>  <span class="st">&quot;AF&quot;</span></span>
<span id="cb27-83"><a href="#cb27-83" aria-hidden="true" tabindex="-1"></a>  UC.data[which.rows, <span class="st">&quot;Series&quot;</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb27-84"><a href="#cb27-84" aria-hidden="true" tabindex="-1"></a>  which.rows <span class="ot">&lt;-</span> <span class="fu">regexpr</span>(<span class="st">&quot;a9&quot;</span>,</span>
<span id="cb27-85"><a href="#cb27-85" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">tolower</span>(<span class="fu">unlist</span>(UC.data[,<span class="st">&quot;Lab.Sample.Name&quot;</span>])))<span class="sc">!=-</span><span class="dv">1</span> <span class="sc">&amp;</span></span>
<span id="cb27-86"><a href="#cb27-86" aria-hidden="true" tabindex="-1"></a>                <span class="fu">is.na</span>(<span class="fu">unlist</span>(UC.data[,<span class="st">&quot;Sample.Type&quot;</span>]))</span>
<span id="cb27-87"><a href="#cb27-87" aria-hidden="true" tabindex="-1"></a>  UC.data[which.rows,<span class="st">&quot;Sample.Type&quot;</span>] <span class="ot">&lt;-</span>  <span class="st">&quot;AF&quot;</span></span>
<span id="cb27-88"><a href="#cb27-88" aria-hidden="true" tabindex="-1"></a>  UC.data[which.rows, <span class="st">&quot;Series&quot;</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb27-89"><a href="#cb27-89" aria-hidden="true" tabindex="-1"></a><span class="co"># Other T1 data:</span></span>
<span id="cb27-90"><a href="#cb27-90" aria-hidden="true" tabindex="-1"></a>  which.rows <span class="ot">&lt;-</span> <span class="fu">regexpr</span>(<span class="st">&quot;t1&quot;</span>,</span>
<span id="cb27-91"><a href="#cb27-91" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">tolower</span>(<span class="fu">unlist</span>(UC.data[,<span class="st">&quot;Lab.Sample.Name&quot;</span>])))<span class="sc">!=-</span><span class="dv">1</span> <span class="sc">&amp;</span></span>
<span id="cb27-92"><a href="#cb27-92" aria-hidden="true" tabindex="-1"></a>                <span class="fu">is.na</span>(<span class="fu">unlist</span>(UC.data[,<span class="st">&quot;Sample.Type&quot;</span>]))</span>
<span id="cb27-93"><a href="#cb27-93" aria-hidden="true" tabindex="-1"></a>  UC.data[which.rows,<span class="st">&quot;Sample.Type&quot;</span>] <span class="ot">&lt;-</span>  <span class="st">&quot;T1&quot;</span></span>
<span id="cb27-94"><a href="#cb27-94" aria-hidden="true" tabindex="-1"></a>  UC.data[which.rows, <span class="st">&quot;Series&quot;</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb27-95"><a href="#cb27-95" aria-hidden="true" tabindex="-1"></a><span class="co"># Other T5 data:</span></span>
<span id="cb27-96"><a href="#cb27-96" aria-hidden="true" tabindex="-1"></a>  which.rows <span class="ot">&lt;-</span> <span class="fu">regexpr</span>(<span class="st">&quot;t5&quot;</span>,</span>
<span id="cb27-97"><a href="#cb27-97" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">tolower</span>(<span class="fu">unlist</span>(UC.data[,<span class="st">&quot;Lab.Sample.Name&quot;</span>])))<span class="sc">!=-</span><span class="dv">1</span> <span class="sc">&amp;</span></span>
<span id="cb27-98"><a href="#cb27-98" aria-hidden="true" tabindex="-1"></a>                <span class="fu">is.na</span>(<span class="fu">unlist</span>(UC.data[,<span class="st">&quot;Sample.Type&quot;</span>]))</span>
<span id="cb27-99"><a href="#cb27-99" aria-hidden="true" tabindex="-1"></a>  UC.data[which.rows,<span class="st">&quot;Sample.Type&quot;</span>] <span class="ot">&lt;-</span>  <span class="st">&quot;T5&quot;</span></span>
<span id="cb27-100"><a href="#cb27-100" aria-hidden="true" tabindex="-1"></a>  UC.data[which.rows, <span class="st">&quot;Series&quot;</span>] <span class="ot">&lt;-</span> <span class="dv">1</span>  </span></code></pre></div>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Get rid of unused samples (QC samples):</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  UC.data <span class="ot">&lt;-</span> <span class="fu">subset</span>(UC.data,<span class="sc">!</span><span class="fu">is.na</span>(Sample.Type))</span></code></pre></div>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to uM:</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  UC.data[,<span class="st">&quot;Std.Conc&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">suppressWarnings</span>(<span class="fu">as.numeric</span>(UC.data[,<span class="st">&quot;NominConc&quot;</span>]))<span class="sc">/</span><span class="dv">1000</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  UC.data[,<span class="st">&quot;Std.Units&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;uM&quot;</span> </span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  UC.data[UC.data[,<span class="st">&quot;Sample.Type&quot;</span>]<span class="sc">!=</span><span class="st">&quot;CC&quot;</span>,<span class="st">&quot;Std.Units&quot;</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span> </span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>  UC.data[UC.data[,<span class="st">&quot;Sample.Type&quot;</span>]<span class="sc">!=</span><span class="st">&quot;CC&quot;</span>,<span class="st">&quot;Std.Conc&quot;</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span> </span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a><span class="co"># We&#39;ll need to go back and set this per sample type:</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>UC.data[UC.data[,<span class="st">&quot;Sample.Type&quot;</span>]<span class="sc">==</span><span class="st">&quot;AF&quot;</span>,<span class="st">&quot;Dilution.Factor&quot;</span>] <span class="ot">&lt;-</span> AF.DILUTE</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>UC.data[UC.data[,<span class="st">&quot;Sample.Type&quot;</span>]<span class="sc">==</span><span class="st">&quot;T1&quot;</span>,<span class="st">&quot;Dilution.Factor&quot;</span>] <span class="ot">&lt;-</span> T1.DILUTE</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>UC.data[UC.data[,<span class="st">&quot;Sample.Type&quot;</span>]<span class="sc">==</span><span class="st">&quot;T5&quot;</span>,<span class="st">&quot;Dilution.Factor&quot;</span>] <span class="ot">&lt;-</span> T5.DILUTE</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>UC.data[UC.data[,<span class="st">&quot;Sample.Type&quot;</span>]<span class="sc">==</span><span class="st">&quot;CC&quot;</span>,<span class="st">&quot;Dilution.Factor&quot;</span>] <span class="ot">&lt;-</span> CC.DILUTE</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>UC.data[UC.data[,<span class="st">&quot;Sample.Type&quot;</span>]<span class="sc">==</span><span class="st">&quot;Blank&quot;</span>,<span class="st">&quot;Dilution.Factor&quot;</span>] <span class="ot">&lt;-</span> BLANK.DILUTE</span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Treat the blanks as calibration data with concentration 0:</span></span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>UC.data[UC.data[,<span class="st">&quot;Sample.Type&quot;</span>]<span class="sc">==</span><span class="st">&quot;Blank&quot;</span>,<span class="st">&quot;Std.Conc&quot;</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>UC.data[UC.data[,<span class="st">&quot;Sample.Type&quot;</span>]<span class="sc">==</span><span class="st">&quot;Blank&quot;</span>,<span class="st">&quot;Std.Units&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;uM&quot;</span></span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>UC.data[UC.data[,<span class="st">&quot;Sample.Type&quot;</span>]<span class="sc">==</span><span class="st">&quot;Blank&quot;</span>,<span class="st">&quot;Sample.Type&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;CC&quot;</span></span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(UC.data)</span></code></pre></div>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get rid of CC samples that don&#39;t have a concentration:</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>UC.data <span class="ot">&lt;-</span> <span class="fu">subset</span>(UC.data,<span class="sc">!</span>(Sample.Type<span class="sc">==</span><span class="st">&quot;CC&quot;</span> <span class="sc">&amp;</span> <span class="fu">is.na</span>(Std.Conc)))</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(UC.data)</span></code></pre></div>
</div>
<div id="set-reasonable-precision" class="section level1">
<h1>Set reasonable precision:</h1>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (this.col <span class="cf">in</span> <span class="fu">c</span>(<span class="st">&quot;Area&quot;</span>, <span class="st">&quot;ISTD.Area&quot;</span>))</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  UC.data[,this.col] <span class="ot">&lt;-</span> <span class="fu">signif</span>(<span class="fu">as.numeric</span>(UC.data[,this.col]),<span class="dv">6</span>)</span></code></pre></div>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>    level1 <span class="ot">&lt;-</span> <span class="fu">format_fup_uc</span>(UC.data,</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">FILENAME=</span><span class="st">&quot;KreutzPFAS&quot;</span>,</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">sample.col=</span><span class="st">&quot;Lab.Sample.Name&quot;</span>,</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">compound.col=</span><span class="st">&quot;Compound.Name&quot;</span>,</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">std.conc.col=</span><span class="st">&quot;Std.Conc&quot;</span>, </span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">lab.compound.col=</span><span class="st">&quot;Lab.Compound.Name&quot;</span>, </span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">type.col=</span><span class="st">&quot;Sample.Type&quot;</span>, </span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">istd.col=</span><span class="st">&quot;ISTD.Area&quot;</span>,</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">note.col=</span><span class="st">&quot;Note&quot;</span>,</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">uc.assay.conc.col=</span><span class="st">&quot;UC.Assay.T0.Conc&quot;</span></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>    level1 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(level1,level1.Jul2020,level1.Dec2020,level1<span class="fl">.900</span>)</span></code></pre></div>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>level1 <span class="ot">&lt;-</span> invitroTKstats<span class="sc">::</span>kreutz2023.uc</span></code></pre></div>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co">#    write.table(UC.data,file=&quot;KreutzPFAS-fup-UC-Level1.tsv&quot;,sep=&quot;\t&quot;,row.names=FALSE)</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>    level2 <span class="ot">&lt;-</span> level1</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Taking all data in spreadsheet as human verified for starters</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>    level2<span class="sc">$</span>Verified <span class="ot">&lt;-</span> <span class="st">&quot;Y&quot;</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># From Anna:</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># UC_513_268_275_812_121921.xlsx</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># something appears off w/ AFS2a- exclude</span></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>    which.rows <span class="ot">&lt;-</span> <span class="fu">regexpr</span>(<span class="st">&quot;S2 AFa&quot;</span>,level2<span class="sc">$</span>Lab.Sample.Name)<span class="sc">!=-</span><span class="dv">1</span> <span class="sc">&amp;</span></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>      level2<span class="sc">$</span>Date <span class="sc">==</span> <span class="st">&quot;2021-10-06&quot;</span></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>    level2[which.rows,<span class="st">&quot;Verified&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;AK: something appears off w/ AFS2a&quot;</span></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># From Anna:</span></span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># UC_971_3135_941_902_956_3145_969_final_020322.xlsx</span></span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># something appears off w/ AFS1a- exclude</span></span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>    which.rows <span class="ot">&lt;-</span> level2<span class="sc">$</span>Date<span class="sc">==</span><span class="st">&quot;2021-09-13&quot;</span> <span class="sc">&amp;</span></span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>      level2<span class="sc">$</span>DTXSID <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;DTXSID1062122&quot;</span>,<span class="st">&quot;DTXSID5044572&quot;</span>) <span class="sc">&amp;</span></span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>      level2<span class="sc">$</span>Sample.Type<span class="sc">==</span><span class="st">&quot;AF&quot;</span> <span class="sc">&amp;</span></span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>      level2<span class="sc">$</span>Series <span class="sc">==</span> <span class="dv">1</span></span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a>    level2[<span class="fu">which</span>(which.rows)[<span class="fu">seq</span>(<span class="dv">1</span>,<span class="fu">length</span>(<span class="fu">which</span>(which.rows)),<span class="dv">3</span>)],<span class="st">&quot;Verified&quot;</span>] <span class="ot">&lt;-</span> </span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;AK: something appears off w/ AFS1a&quot;</span></span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb34-24"><a href="#cb34-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># If not response in assay sample assume bad:</span></span>
<span id="cb34-25"><a href="#cb34-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (this.type <span class="cf">in</span> <span class="fu">c</span>(<span class="st">&quot;T1&quot;</span>,<span class="st">&quot;T5&quot;</span>))</span>
<span id="cb34-26"><a href="#cb34-26" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb34-27"><a href="#cb34-27" aria-hidden="true" tabindex="-1"></a>      which.rows <span class="ot">&lt;-</span> level2<span class="sc">$</span>Sample.Type<span class="sc">==</span>this.type <span class="sc">&amp;</span> level2<span class="sc">$</span>Area<span class="sc">==</span><span class="dv">0</span></span>
<span id="cb34-28"><a href="#cb34-28" aria-hidden="true" tabindex="-1"></a>      which.rows[<span class="fu">is.na</span>(which.rows)] <span class="ot">&lt;-</span> <span class="cn">FALSE</span></span>
<span id="cb34-29"><a href="#cb34-29" aria-hidden="true" tabindex="-1"></a>      level2[which.rows,<span class="st">&quot;Verified&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;JFW: Excluded for no response&quot;</span></span>
<span id="cb34-30"><a href="#cb34-30" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb34-31"><a href="#cb34-31" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb34-32"><a href="#cb34-32" aria-hidden="true" tabindex="-1"></a>    <span class="co"># No cal curve 4NT (Nom.Conc &gt;0, Area = 0):</span></span>
<span id="cb34-33"><a href="#cb34-33" aria-hidden="true" tabindex="-1"></a>    which.rows <span class="ot">&lt;-</span> level2<span class="sc">$</span>Lab.Sample.Name <span class="sc">==</span> <span class="st">&quot;4NT&quot;</span> <span class="sc">&amp;</span> level2<span class="sc">$</span>Area <span class="sc">==</span> <span class="dv">0</span></span>
<span id="cb34-34"><a href="#cb34-34" aria-hidden="true" tabindex="-1"></a>    level2[which.rows,<span class="st">&quot;Verified&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;JFW: Excluded, likely not analyzed&quot;</span></span>
<span id="cb34-35"><a href="#cb34-35" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb34-36"><a href="#cb34-36" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Can&#39;t work without peak for ISTD:</span></span>
<span id="cb34-37"><a href="#cb34-37" aria-hidden="true" tabindex="-1"></a>    which.rows <span class="ot">&lt;-</span> level2<span class="sc">$</span>ISTD.Area <span class="sc">==</span> <span class="dv">0</span></span>
<span id="cb34-38"><a href="#cb34-38" aria-hidden="true" tabindex="-1"></a>    level2[which.rows,<span class="st">&quot;Verified&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;JFW: Excluded, no ISTD peak&quot;</span></span></code></pre></div>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 476, 3125, 273: only in S1</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 267, 906: only in S2</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 915, 965, 913: only in S3</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>  level2[(<span class="fu">regexpr</span>(<span class="st">&quot;s2&quot;</span>,<span class="fu">tolower</span>(level2<span class="sc">$</span>Lab.Sample.Name))<span class="sc">!=-</span><span class="dv">1</span> <span class="sc">|</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>          <span class="fu">regexpr</span>(<span class="st">&quot;s3&quot;</span>,<span class="fu">tolower</span>(level2<span class="sc">$</span>Lab.Sample.Name))<span class="sc">!=-</span><span class="dv">1</span>) <span class="sc">&amp;</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>          level2<span class="sc">$</span>Lab.Compound.Name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;476&quot;</span>,<span class="st">&quot;3125&quot;</span>,<span class="st">&quot;273&quot;</span>),</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>         <span class="st">&quot;Verified&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;JFW: Seems that test substance only in S1&quot;</span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>  level2[(<span class="fu">regexpr</span>(<span class="st">&quot;s1&quot;</span>,<span class="fu">tolower</span>(level2<span class="sc">$</span>Lab.Sample.Name))<span class="sc">!=-</span><span class="dv">1</span> <span class="sc">|</span></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>          <span class="fu">regexpr</span>(<span class="st">&quot;s3&quot;</span>,<span class="fu">tolower</span>(level2<span class="sc">$</span>Lab.Sample.Name))<span class="sc">!=-</span><span class="dv">1</span>) <span class="sc">&amp;</span></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>          level2<span class="sc">$</span>Lab.Compound.Name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;267&quot;</span>,<span class="st">&quot;906&quot;</span>),</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>         <span class="st">&quot;Verified&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;JFW: Seems that test substance only in S2&quot;</span></span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>  level2[(<span class="fu">regexpr</span>(<span class="st">&quot;s1&quot;</span>,<span class="fu">tolower</span>(level2<span class="sc">$</span>Lab.Sample.Name))<span class="sc">!=-</span><span class="dv">1</span> <span class="sc">|</span></span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>          <span class="fu">regexpr</span>(<span class="st">&quot;s2&quot;</span>,<span class="fu">tolower</span>(level2<span class="sc">$</span>Lab.Sample.Name))<span class="sc">!=-</span><span class="dv">1</span>) <span class="sc">&amp;</span></span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>          level2<span class="sc">$</span>Lab.Compound.Name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;915&quot;</span>,<span class="st">&quot;965&quot;</span>,<span class="st">&quot;913&quot;</span>),</span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>         <span class="st">&quot;Verified&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;JFW: Seems that test substance only in S3&quot;</span></span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>  level2[<span class="fu">regexpr</span>(<span class="st">&quot;2a&quot;</span>,<span class="fu">tolower</span>(level2<span class="sc">$</span>Lab.Sample.Name))<span class="sc">!=-</span><span class="dv">1</span> <span class="sc">&amp;</span></span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>          level2<span class="sc">$</span>Lab.Compound.Name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;276&quot;</span>,<span class="st">&quot;467&quot;</span>),</span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a>         <span class="st">&quot;Verified&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;JFW: Seems that test substance only in series B&quot;</span></span></code></pre></div>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>ISTDTHRESH <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>gooddata <span class="ot">&lt;-</span> level2<span class="sc">$</span>ISTD.Area</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>gooddata[<span class="fu">is.na</span>(gooddata)] <span class="ot">&lt;-</span> ISTDTHRESH</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>  level2[gooddata <span class="sc">&lt;</span> ISTDTHRESH, <span class="st">&quot;Verified&quot;</span>] <span class="ot">&lt;-</span> </span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste</span>(<span class="st">&quot;Excluded for ISTD Peak smaller than&quot;</span>, ISTDTHRESH)</span></code></pre></div>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>level2[<span class="fu">is.na</span>(level2<span class="sc">$</span>Response),<span class="st">&quot;Verified&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;JFW: Excluded for NA Response&quot;</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="co">#ccobs &lt;- regexpr(&quot;CC&quot;,level2$Lab.Sample.Name)!=-1 </span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="co">#zeroobs &lt;- level2$Area==0</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a><span class="co">#zeroobs[is.na(zeroobs)] &lt;- FALSE</span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a><span class="co">#blanks &lt;- level2$Standard.Conc == 0</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a><span class="co">#blanks[is.na(blanks)] &lt;- FALSE</span></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a><span class="co">#level2[ccobs &amp; zeroobs &amp; !blanks,&quot;Verified&quot;] &lt;-&quot;JFW: Excluded cal curve no signal&quot;</span></span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (this.id <span class="cf">in</span> <span class="fu">c</span>(</span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;DTXSID50369896&quot;</span>,</span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;DTXSID3059927&quot;</span>,</span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;DTXSID1047578&quot;</span>,</span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;DTXSID30396867&quot;</span>,</span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;DTXSID00380798&quot;</span>,</span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;DTXSID30395037&quot;</span>,</span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;DTXSID30340244&quot;</span>  </span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb37-20"><a href="#cb37-20" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb37-21"><a href="#cb37-21" aria-hidden="true" tabindex="-1"></a>  obsid <span class="ot">&lt;-</span> level2<span class="sc">$</span>DTXSID<span class="sc">==</span>this.id</span>
<span id="cb37-22"><a href="#cb37-22" aria-hidden="true" tabindex="-1"></a>  obszero <span class="ot">&lt;-</span> level2<span class="sc">$</span>Area<span class="sc">==</span><span class="dv">0</span></span>
<span id="cb37-23"><a href="#cb37-23" aria-hidden="true" tabindex="-1"></a>  obszero[<span class="fu">is.na</span>(obszero)] <span class="ot">&lt;-</span> <span class="cn">FALSE</span></span>
<span id="cb37-24"><a href="#cb37-24" aria-hidden="true" tabindex="-1"></a>  level2[obsid <span class="sc">&amp;</span> obszero, <span class="st">&quot;Verified&quot;</span>] <span class="ot">&lt;-</span></span>
<span id="cb37-25"><a href="#cb37-25" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;JFW: Excluded for lack of signal&quot;</span></span>
<span id="cb37-26"><a href="#cb37-26" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>R2THRESH <span class="ot">&lt;-</span> <span class="fl">0.9</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (this.id <span class="cf">in</span> <span class="fu">unique</span>(level2<span class="sc">$</span>DTXSID))</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>  these.cals <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">subset</span>(level2, DTXSID<span class="sc">==</span>this.id)<span class="sc">$</span>Calibration)</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (this.cal <span class="cf">in</span> these.cals)</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>    this.subset <span class="ot">&lt;-</span> <span class="fu">subset</span>(level2,</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>                          DTXSID <span class="sc">==</span> this.id <span class="sc">&amp;</span></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>                          Calibration <span class="sc">==</span> this.cal <span class="sc">&amp;</span></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>                          Sample.Type <span class="sc">==</span> <span class="st">&quot;CC&quot;</span> <span class="sc">&amp;</span></span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>                          Verified <span class="sc">==</span> <span class="st">&quot;Y&quot;</span>)</span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">dim</span>(this.subset)[<span class="dv">1</span>] <span class="sc">&gt;</span> <span class="dv">1</span>)</span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>      this.fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(Response <span class="sc">~</span> Standard.Conc, <span class="at">data=</span>this.subset)</span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>      <span class="cf">while</span> (<span class="fu">summary</span>(this.fit)<span class="sc">$</span>adj.r.squared <span class="sc">&lt;</span> R2THRESH  <span class="sc">&amp;</span> </span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a>             <span class="fu">dim</span>(this.subset)[<span class="dv">1</span>] <span class="sc">&gt;</span> <span class="dv">1</span> <span class="sc">&amp;</span></span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a>             <span class="fu">any</span>(this.subset<span class="sc">$</span>Area<span class="sc">&gt;</span><span class="dv">0</span>))</span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a>      {</span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a>        <span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">&quot;Removing outliers for&quot;</span>,this.id,<span class="st">&quot;calibration&quot;</span>,this.cal,<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>))</span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a>        bad.sample <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">abs</span>(this.fit<span class="sc">$</span>residuals) <span class="sc">==</span> </span>
<span id="cb38-21"><a href="#cb38-21" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">max</span>(<span class="fu">abs</span>(this.fit<span class="sc">$</span>residuals)))</span>
<span id="cb38-22"><a href="#cb38-22" aria-hidden="true" tabindex="-1"></a>        bad.name <span class="ot">&lt;-</span> this.subset[bad.sample, <span class="st">&quot;Lab.Sample.Name&quot;</span>]</span>
<span id="cb38-23"><a href="#cb38-23" aria-hidden="true" tabindex="-1"></a>        level2[level2<span class="sc">$</span>DTXSID <span class="sc">==</span> this.id <span class="sc">&amp;</span></span>
<span id="cb38-24"><a href="#cb38-24" aria-hidden="true" tabindex="-1"></a>               level2<span class="sc">$</span>Calibration <span class="sc">==</span> this.cal <span class="sc">&amp;</span></span>
<span id="cb38-25"><a href="#cb38-25" aria-hidden="true" tabindex="-1"></a>               level2<span class="sc">$</span>Sample.Type <span class="sc">==</span> <span class="st">&quot;CC&quot;</span> <span class="sc">&amp;</span></span>
<span id="cb38-26"><a href="#cb38-26" aria-hidden="true" tabindex="-1"></a>               level2<span class="sc">$</span>Lab.Sample.Name <span class="sc">==</span> bad.name,</span>
<span id="cb38-27"><a href="#cb38-27" aria-hidden="true" tabindex="-1"></a>               <span class="st">&quot;Verified&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">paste</span>(</span>
<span id="cb38-28"><a href="#cb38-28" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&quot;Excluded algorithmically as outlier (R2 &lt; &quot;</span>,</span>
<span id="cb38-29"><a href="#cb38-29" aria-hidden="true" tabindex="-1"></a>                 R2THRESH,<span class="st">&quot;)&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb38-30"><a href="#cb38-30" aria-hidden="true" tabindex="-1"></a>        this.subset <span class="ot">&lt;-</span> <span class="fu">subset</span>(level2,</span>
<span id="cb38-31"><a href="#cb38-31" aria-hidden="true" tabindex="-1"></a>                              DTXSID <span class="sc">==</span> this.id <span class="sc">&amp;</span></span>
<span id="cb38-32"><a href="#cb38-32" aria-hidden="true" tabindex="-1"></a>                              Calibration <span class="sc">==</span> this.cal <span class="sc">&amp;</span></span>
<span id="cb38-33"><a href="#cb38-33" aria-hidden="true" tabindex="-1"></a>                              Sample.Type <span class="sc">==</span> <span class="st">&quot;CC&quot;</span> <span class="sc">&amp;</span></span>
<span id="cb38-34"><a href="#cb38-34" aria-hidden="true" tabindex="-1"></a>                              Verified <span class="sc">==</span> <span class="st">&quot;Y&quot;</span>)</span>
<span id="cb38-35"><a href="#cb38-35" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb38-36"><a href="#cb38-36" aria-hidden="true" tabindex="-1"></a>        this.fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(Response <span class="sc">~</span> Standard.Conc, <span class="at">data=</span>this.subset)     </span>
<span id="cb38-37"><a href="#cb38-37" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb38-38"><a href="#cb38-38" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="fu">all</span>(this.subset<span class="sc">$</span>Area<span class="sc">==</span><span class="dv">0</span>))</span>
<span id="cb38-39"><a href="#cb38-39" aria-hidden="true" tabindex="-1"></a>      {</span>
<span id="cb38-40"><a href="#cb38-40" aria-hidden="true" tabindex="-1"></a>        level2[</span>
<span id="cb38-41"><a href="#cb38-41" aria-hidden="true" tabindex="-1"></a>          level2<span class="sc">$</span>DTXSID <span class="sc">==</span> this.id <span class="sc">&amp;</span></span>
<span id="cb38-42"><a href="#cb38-42" aria-hidden="true" tabindex="-1"></a>          level2<span class="sc">$</span>Calibration <span class="sc">==</span> this.cal <span class="sc">&amp;</span></span>
<span id="cb38-43"><a href="#cb38-43" aria-hidden="true" tabindex="-1"></a>          level2<span class="sc">$</span>Sample.Type <span class="sc">==</span> <span class="st">&quot;CC&quot;</span> <span class="sc">&amp;</span></span>
<span id="cb38-44"><a href="#cb38-44" aria-hidden="true" tabindex="-1"></a>          level2<span class="sc">$</span>Verified <span class="sc">==</span> <span class="st">&quot;Y&quot;</span>, <span class="st">&quot;Verified&quot;</span>] <span class="ot">&lt;-</span> </span>
<span id="cb38-45"><a href="#cb38-45" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;Excluded because remaining CC had area 0&quot;</span></span>
<span id="cb38-46"><a href="#cb38-46" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb38-47"><a href="#cb38-47" aria-hidden="true" tabindex="-1"></a>   }</span>
<span id="cb38-48"><a href="#cb38-48" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb38-49"><a href="#cb38-49" aria-hidden="true" tabindex="-1"></a>   <span class="co"># if (this.id== &quot;DTXSID4059916&quot;) browser()</span></span>
<span id="cb38-50"><a href="#cb38-50" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb38-51"><a href="#cb38-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-52"><a href="#cb38-52" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## Removing outliers for DTXSID20335129 calibration 2021-10-06 
## Removing outliers for DTXSID90190949 calibration 2021-11-16 
## Removing outliers for DTXSID50184723 calibration 2021-11-16 
## Removing outliers for DTXSID5023792 calibration 2021-11-16 
## Removing outliers for DTXSID5059828 calibration 2021-11-16 
## Removing outliers for DTXSID7060332 calibration 2021-11-16 
## Removing outliers for DTXSID90880156 calibration 2021-07-16 
## Removing outliers for DTXSID3059927 calibration 2021-04-20 
## Removing outliers for DTXSID50369896 calibration 2021-04-20</code></pre>
<p>Somethings weird with this chemicals data, clean up the odder
samples:</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>which.rows <span class="ot">&lt;-</span> <span class="fu">which</span>(level2<span class="sc">$</span>DTXSID<span class="sc">==</span><span class="st">&quot;DTXSID20335129&quot;</span>)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Overule outlier detection:</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>level2[which.rows,<span class="st">&quot;Verified&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Y&quot;</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Get rid of spike:</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>level2[level2<span class="sc">$</span>DTXSID<span class="sc">==</span><span class="st">&quot;DTXSID20335129&quot;</span> <span class="sc">&amp;</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>       level2<span class="sc">$</span>Lab.Sample.Name<span class="sc">==</span><span class="st">&quot;UCCC spike&quot;</span>, <span class="st">&quot;Verified&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Spike&quot;</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>level2[which.rows[<span class="dv">24</span><span class="sc">:</span><span class="dv">29</span>], <span class="st">&quot;Verified&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Extra CC&quot;</span></span></code></pre></div>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(level2,</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">file=</span><span class="st">&quot;KreutzPFAS-fup-UC-Level2.tsv&quot;</span>,</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">sep=</span><span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>,</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">row.names=</span>F,</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">quote=</span>F)</span></code></pre></div>
</div>
<div id="maximum-likelihood-analysis" class="section level1">
<h1>maximum likelihood analysis:</h1>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>    level3 <span class="ot">&lt;-</span> <span class="fu">calc_fup_uc_point</span>(<span class="at">FILENAME=</span><span class="st">&quot;KreutzPFAS&quot;</span>) </span></code></pre></div>
<pre><code>## [1] &quot;1,6-Dibromododecafluorohexane f_up = 0&quot;
## [1] &quot;1H,1H,5H-Perfluoropentyl methacrylate f_up = 0.249&quot;
## [1] &quot;Perfluoro-1,4-diiodobutane f_up = 0.00533&quot;
## [1] &quot;1,6-Diiodoperfluorohexane f_up = 0.267&quot;
## [1] &quot;1H,1H-Perfluoroheptylamine f_up = 0.121&quot;
## [1] &quot;1H,1H-Perfluorooctylamine f_up = 0.261&quot;
## [1] &quot;1H,1H-Perfluorononylamine f_up = 0.0359&quot;
## [1] &quot;4-nitrotoluene f_up = 0.0612&quot;
## [1] &quot;1-Iodopentadecafluoroheptane f_up = 0.887&quot;
## [1] &quot;(Perfluorobutyryl)-2-thenoylmethane f_up = 0.00288&quot;
## [1] &quot;1-Iodo-1H,1H,2H,2H-perfluorononane f_up = 0.0419&quot;
## [1] &quot;(Perfluoro-5-methylhexyl)ethyl 2-methylprop-2-enoate f_up = 0.0201&quot;
## [1] &quot;((2,2,3,3-Tetrafluoropropoxy)methyl)oxirane f_up = 0.289&quot;
## [1] &quot;1H,1H,7H-Perfluoroheptyl 4-methylbenzenesulfonate f_up = 0.0275&quot;
## [1] &quot;tris(Trifluoroethoxy)methane f_up = 0.0994&quot;
## [1] &quot;1H,1H,11H,11H-Perfluorotetraethylene glycol f_up = 0.0127&quot;
## [1] &quot;1H,1H,8H,8H-Perfluorooctane-1,8-diol f_up = 0.0506&quot;
## [1] &quot;Bis(1H,1H-perfluoropropyl)amine f_up = 0.0216&quot;
## [1] &quot;1H,1H,8H,8H-Perfluoro-3,6-dioxaoctane-1,8-diol f_up = 0.207&quot;
## [1] &quot;4:2 Fluorotelomer alcohol f_up = 0.231&quot;
## [1] &quot;6:1 Fluorotelomer alcohol f_up = 0.0386&quot;
## [1] &quot;6:2 Fluorotelomer alcohol f_up = 0.152&quot;
## [1] &quot;4:4 Fluorotelomer alcohol f_up = 0.0704&quot;
## [1] &quot;8:2 Fluorotelomer alcohol f_up = 0.0243&quot;
## [1] &quot;Methyl perfluoro(3-(1-ethenyloxypropan-2-yloxy)propanoate) f_up = 0.0235&quot;
## [1] &quot;11:1 Fluorotelomer alcohol f_up = 0.0621&quot;
## [1] &quot;6:2 Fluorotelomer methacrylate f_up = 0.0856&quot;
## [1] &quot;1H,1H-Perfluorobutyl methacrylate f_up = 0.706&quot;
## [1] &quot;1H,1H,9H-Perfluorononyl acrylate f_up = 0.315&quot;
## [1] &quot;2,2,3,3-Tetrafluoropropyl acrylate f_up = 0.234&quot;
## [1] &quot;2-(Perfluorobutyl)ethyl acrylate f_up = 0.078&quot;
## [1] &quot;1H,1H,5H,5H-Perfluoro-1,5-pentanediol diacrylate f_up = 0.177&quot;
## [1] &quot;1H,1H-Perfluorooctyl methacrylate f_up = 0.0665&quot;
## [1] &quot;8:2 Fluorotelomer methacrylate f_up = 0.0503&quot;
## [1] &quot;Heptafluorobutyramide f_up = 0.601&quot;
## [1] &quot;Nonafluoropentanamide f_up = 0.199&quot;
## [1] &quot;Perfluoropentanamide f_up = 0.516&quot;
## [1] &quot;Octafluoroadipamide f_up = 0.834&quot;
## [1] &quot;Perfluorooctanamide f_up = 0.0263&quot;
## [1] &quot;Heptafluorobutanol f_up = 0.497&quot;
## [1] &quot;3-(Perfluoropropyl)propanol f_up = 0.205&quot;
## [1] &quot;N-Methyl-N-trimethylsilylheptafluorobutyramide f_up = 0.545&quot;
## [1] &quot;3-(Perfluorooctyl)propanol f_up = 0.0352&quot;
## [1] &quot;Perfluorooctanamidine f_up = 0.0261&quot;
## [1] &quot;Dodecafluoroheptanol f_up = 0.0549&quot;
## [1] &quot;Pentafluoropropionamide f_up = 0.789&quot;
## [1] &quot;3-(Perfluoro-2-butyl)propane-1,2-diol f_up = 0.369&quot;
## [1] &quot;2-Aminohexafluoropropan-2-ol f_up = 0.963&quot;
## [1] &quot;1H,1H,5H-Perfluoropentanol f_up = 0.355&quot;
## [1] &quot;Fraction unbound values calculated for 49 chemicals.&quot;
## [1] &quot;Fraction unbound values calculated for 63 measurements.&quot;</code></pre>
</div>
<div id="bayesian-analysis" class="section level1">
<h1>Bayesian analysis:</h1>
<p>The following code can take a long time to run and so “eval = FALSE”
is set by default. You must manually run this code or change to “eval =
TRUE”.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(invitroTKstats) </span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="fu">setwd</span>(<span class="st">&quot;c:/users/jwambaug/git/invitroTKstats/working/KreutzPFAS/&quot;</span>)</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>level4 <span class="ot">&lt;-</span> <span class="fu">calc_fup_uc</span>(<span class="at">FILENAME=</span><span class="st">&quot;KreutzPFAS&quot;</span>,</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>                      <span class="at">NUM.CORES=</span><span class="dv">8</span>,</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">JAGS.PATH=</span><span class="st">&quot;C:/Users/jwambaug/AppData/Local/JAGS/JAGS-4.3.0/x64&quot;</span>) </span></code></pre></div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
