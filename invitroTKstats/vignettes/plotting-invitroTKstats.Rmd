---
title: "invitroTKstats Plotting Functions Demonstration"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{plotting-invitroTKstats}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

## Introduction
The goal of this vignette is to showcase the two plotting functions in `invitroTKstats`, namely `plot_clint` and `plot_fup_uc`. The input data for these two functions should be Level-2 data. Level-2 data is Level-1 data returned from `format_clint` and `format_fup_uc`, respectively, then curated with a verification column. "Y" in the verification column indicates the data row is valid for analysis and plotting. 

## Set up
```{r setup, warning=FALSE}
library(invitroTKstats)
library(ggplot2)
library(gridExtra)
```

## plot_clint.R
`plot_clint` generates a time-versus-response scatter plot for a specified chemical. The data set used in this example is `kreutz2023.clint`. 

```{r example clint, warning=FALSE, fig.width=7.5, fig.height=8}
# Load data in 
level2.clint <- invitroTKstats::kreutz2023.clint

# manually correct conc column name 
colnames(level2.clint)[which(names(level2.clint) == "Std.Conc")] <- "Conc"

# keep only the verified data
verified_data_clint <- level2.clint[level2.clint$Verified == "Y", ]

# plot the first four chemicals 
p <- list()
for (id in unique(verified_data_clint$DTXSID)[1:4]) {
  p[[id]] <- plot_clint(verified_data_clint, id) + theme(legend.title = element_text(size = 5),
                                                         legend.text = element_text(size = 5),
                                                         plot.title = element_text(size=7))
}
do.call(grid.arrange,p)
```

**Figure 1:** These four plots are examples of plots generated by `plot_clint`. Each point represents a response and is labeled with different shapes by sample types and colored by calibrations. 

## plot_fup_uc.R
`plot_fup_uc` generates a response by sample type plot for a specified chemical. The data set used in this example is `kreutz2023.uc`. 

```{r example fup_uc, warning=FALSE, fig.height=8, fig.width=7.5}
# load in data
level2.uc <- invitroTKstats::kreutz2023.uc

# keep only the verified data
verified_data_uc <- level2.uc[level2.uc$Verified == "Y", ]

# plot the first four chemicals 
p2 <- list()
for (id in unique(verified_data_uc$DTXSID)[1:4]) {
  p2[[id]] <- plot_fup_uc(verified_data_uc, id) + theme(legend.title = element_text(size = 5),
                                                        legend.text = element_text(size = 5),
                                                        plot.title = element_text(size=7))
}
do.call(grid.arrange,p2)
```

**Figure 2:** These four plots are examples of plots generated by `plot_fup_uc`. Each point represents a response and the calibration is indicated by different colors and shape combinations.

