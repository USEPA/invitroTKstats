---
title: "invitroTKstats Plotting Functions Demonstration"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{plotting-invitroTKstats}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
library(invitroTKstats)
```


## Introduction
The goal of this vignette is to showcase the two plotting functions in `invitroTKstats`, `plot_clint` and `plot_fup_uc`. The input data to these two functions should Level-2 data. Level-2 data is Level-1, data formatted with the \code{\link{format_clint}} function, and curated with a verification column. "Y" in the verification column indicates the data row is valid for analysis and plotting. 

## plot_clint.R
`plot_clint` generates a time-versus-responses scatter plot for one specified chemical. The data set used in this example is `kreutz2023.clint` from `Kreutz2023.RData`. 

```{r example clint, warning=FALSE, fig.height=4.5, fig.width=7}
# Load data in 
level2.clint <- invitroTKstats::kreutz2023.clint

# manually correct conc column name 
colnames(level2.clint)[which(names(level2.clint) == "Std.Conc")] <- "Conc"

# In the Clintdata vignette, it states
# Barbara determined that only the following chemicals have reliable data:
subset <- level2.clint[level2.clint$DTXSID %in% c(
  "DTXSID0059871",
  "DTXSID3059927",
  "DTXSID80310730",
  "DTXSID70381090",
  "DTXSID10382147",
  "DTXSID70366226",
  "DTXSID2060965",
  "DTXSID30396867",
  "DTXSID00380798",
  "DTXSID30340244",
  "DTXSID60400587",
  "DTXSID1062122",
  "DTXSID50369896"), ]


# plot the first four chemicals 
for (id in unique(subset$DTXSID)[1:4]) {
  print(plot_clint(subset, id))
}
```

**Figure 1:** These fours plots are examples of plot generated by `plot_clint`. Each point represents a response and is labelled with different shapes by sample types and colored by calibrations. 

## plot_fup_uc.R
`plot_fup_uc` generates a responses by sample type plot for one specified chemical. The data set used in this example is `kreutz2023.uc` from `Kreutz2023.RData`. 

```{r example fup_uc, warning=FALSE, fig.height=4.5, fig.width=7}
# load in data
level2.uc <- invitroTKstats::kreutz2023.uc

# plot the first four chemicals 
for (id in unique(level2.uc$DTXSID)[1:4]) {
  print(plot_fup_uc(level2.uc, id))
}
```

**Figure 2:** These fours plots are examples of plot generated by `plot_fup_uc`. Each point represents a response and is colored by calibrations. 

